{
  "version": 3,
  "sources": ["../bundle-tMlVQF/checked-fetch.js", "../../../workers/youtube-proxy.js", "../../../../../../../../../../home/littl/.nvm/versions/node/v22.19.0/lib/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../../../../../../../../home/littl/.nvm/versions/node/v22.19.0/lib/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-tMlVQF/middleware-insertion-facade.js", "../../../../../../../../../../home/littl/.nvm/versions/node/v22.19.0/lib/node_modules/wrangler/templates/middleware/common.ts", "../bundle-tMlVQF/middleware-loader.entry.ts"],
  "sourceRoot": "/mnt/c/Users/littl/app-dev/05_YouTubeListTool/YouTubeListTool/.wrangler/tmp/dev-HXM186",
  "sourcesContent": ["const urls = new Set();\n\nfunction checkURL(request, init) {\n\tconst url =\n\t\trequest instanceof URL\n\t\t\t? request\n\t\t\t: new URL(\n\t\t\t\t\t(typeof request === \"string\"\n\t\t\t\t\t\t? new Request(request, init)\n\t\t\t\t\t\t: request\n\t\t\t\t\t).url\n\t\t\t\t);\n\tif (url.port && url.port !== \"443\" && url.protocol === \"https:\") {\n\t\tif (!urls.has(url.toString())) {\n\t\t\turls.add(url.toString());\n\t\t\tconsole.warn(\n\t\t\t\t`WARNING: known issue with \\`fetch()\\` requests to custom HTTPS ports in published Workers:\\n` +\n\t\t\t\t\t` - ${url.toString()} - the custom port will be ignored when the Worker is published using the \\`wrangler deploy\\` command.\\n`\n\t\t\t);\n\t\t}\n\t}\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\tconst [request, init] = argArray;\n\t\tcheckURL(request, init);\n\t\treturn Reflect.apply(target, thisArg, argArray);\n\t},\n});\n", "/**\n * YouTube List Tool - Enhanced Cloudflare Worker\n *\n * \u542B\u307E\u308C\u308B\u6A5F\u80FD:\n * - CORS Proxy\uFF08YouTube RSS\u5C02\u7528\uFF09\n * - /resolve-channel: @handle \u2192 channelId \u89E3\u6C7A\n * - /fetch-videos: YouTube Data API v3 \u304B\u3089\u6BB5\u968E\u7684\u306B\u52D5\u753B\u4E00\u89A7\u53D6\u5F97\n * - CORS \u6539\u5584\uFF08Cloudflare Pages \u30D7\u30EC\u30D3\u30E5\u30FC\u5BFE\u5FDC\uFF09\n * - Durable Objects \u306B\u3088\u308B\u30EC\u30FC\u30C8\u5236\u9650\uFF08RateLimiter\uFF09\n * - Cache API \u306B\u3088\u308B 5 \u5206\u30AD\u30E3\u30C3\u30B7\u30E5\uFF08RSS/\u89E3\u6C7A/\u52D5\u753B\u53D6\u5F97\uFF09\n * - \u30A8\u30E9\u30FC\u30CF\u30F3\u30C9\u30EA\u30F3\u30B0\u7D71\u4E00\uFF08\u65E5\u672C\u8A9E\u30E1\u30C3\u30BB\u30FC\u30B8 + \u30A8\u30E9\u30FC\u30B3\u30FC\u30C9\uFF09\n *\n * \u6CE8\u610F:\n * - \u65E2\u5B58\u306E\u30A8\u30F3\u30C9\u30DD\u30A4\u30F3\u30C8\u3068\u69CB\u9020\u3092\u7DAD\u6301\u3057\u3064\u3064\u3001\u65B0\u6A5F\u80FD\u3092\u7D71\u5408\u3057\u3066\u3044\u307E\u3059\u3002\n * - \u4F9D\u5B58: env.YT_API_KEY \u307E\u305F\u306F env.YOUTUBE_API_KEY\uFF08\u3044\u305A\u308C\u304B\u5FC5\u9808\uFF09\n * - Durable Object: env.RATE_LIMITER \u306B\u30D0\u30A4\u30F3\u30C9\u6E08\u307F\u3067\u3042\u308B\u3053\u3068\uFF08wrangler.toml\uFF09\n */\n\n// \u8A31\u53EF\u3059\u308B\u30AA\u30EA\u30B8\u30F3\uFF08\u672C\u756A\u74B0\u5883\u306EURL\u306B\u5909\u66F4\u3057\u3066\u304F\u3060\u3055\u3044\uFF09\nconst ALLOWED_ORIGINS = [\n  'http://localhost:8000',\n  'http://localhost:3000',\n  'http://127.0.0.1:8000',\n  'https://youtubelisttool.pages.dev', // Cloudflare Pages \u672C\u756AURL\n];\n\n// Cloudflare Pages \u306E\u30D7\u30EC\u30D3\u30E5\u30FCURL\u3092\u8A31\u53EF\uFF08\u4F8B: https://a1b2c3.youtubelisttool.pages.dev\uFF09\nconst PREVIEW_ORIGIN_REGEX = /^https:\\/\\/[a-z0-9-]+\\.youtubelisttool\\.pages\\.dev$/i;\n\n// YouTube RSS URL\u306E\u30D1\u30BF\u30FC\u30F3\uFF08\u30DB\u30EF\u30A4\u30C8\u30EA\u30B9\u30C8\u65B9\u5F0F\uFF09\nconst YOUTUBE_RSS_PATTERN = /^https:\\/\\/www\\.youtube\\.com\\/feeds\\/videos\\.xml\\?channel_id=UC[\\w-]{22}$/;\n\n// YouTube Data API \u30D9\u30FC\u30B9URL\nconst YT_API_BASE = 'https://www.googleapis.com/youtube/v3';\n\n// \u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u7B49\u306E\u5B9A\u6570\nconst DEFAULT_TIMEOUT_MS = 10000; // \u65E2\u5B58RSS\u30D7\u30ED\u30AD\u30B7\u306E\u30C7\u30D5\u30A9\u30EB\u30C8\nconst FETCH_VIDEOS_TIMEOUT_MS = 30000; // /fetch-videos \u306E API \u547C\u3073\u51FA\u3057\u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\nconst MAX_PAGE_RESULTS = 50; // YouTube API \u306E\u4E0A\u9650\nconst MAX_PAGES = 10; // 1\u30EA\u30AF\u30A8\u30B9\u30C8\u3042\u305F\u308A\u306E\u6700\u5927\u30DA\u30FC\u30B8\u6570\nconst CACHE_TTL_SECONDS = 300; // 5\u5206\u30AD\u30E3\u30C3\u30B7\u30E5\nconst USER_AGENT = 'YouTubeListTool-Worker/1.0 (+https://youtubelisttool.pages.dev)';\n\n// \u30A8\u30E9\u30FC\u30B3\u30FC\u30C9\u306E\u5B9A\u7FA9\uFF08\u7D71\u4E00\uFF09\nconst ERROR_CODES = {\n  QUOTA_EXCEEDED: 'quota_exceeded', // 403 - \u30AF\u30A9\u30FC\u30BF\u8D85\u904E\n  RATE_LIMITED: 'rate_limited', // 429 - \u30EC\u30FC\u30C8\u5236\u9650\uFF08Durable Object\uFF09\n  INVALID_KEY: 'invalid_key', // 401 - API\u30AD\u30FC\u7121\u52B9\n  NOT_FOUND: 'not_found', // 404 - \u898B\u3064\u304B\u3089\u306A\u3044\n  INVALID_CHANNEL_ID: 'invalid_channel_id', // 400 - \u30C1\u30E3\u30F3\u30CD\u30EBID\u5F62\u5F0F\u30A8\u30E9\u30FC\n  BAD_REQUEST: 'bad_request', // 400 - \u4E0D\u6B63\u306A\u30EA\u30AF\u30A8\u30B9\u30C8\n  TIMEOUT: 'timeout', // 504 - \u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\n};\n\n/**\n * \u30E1\u30A4\u30F3\u306E\u30EA\u30AF\u30A8\u30B9\u30C8\u30CF\u30F3\u30C9\u30E9\u30FC\n */\nexport default {\n  async fetch(request, env, ctx) {\n    // Origin\u30C1\u30A7\u30C3\u30AF\uFF1A\u8A31\u53EF\u3055\u308C\u3066\u3044\u306A\u3044\u5834\u5408\u306F403\u3092\u8FD4\u3059\n    const origin = request.headers.get('Origin');\n    if (origin && !isOriginAllowed(origin)) {\n      return new Response('Forbidden: Origin not allowed', {\n        status: 403,\n        headers: {\n          'Content-Type': 'text/plain; charset=utf-8',\n        },\n      });\n    }\n\n    // CORS \u30D7\u30EA\u30D5\u30E9\u30A4\u30C8\u30EA\u30AF\u30A8\u30B9\u30C8\u306E\u51E6\u7406\n    if (request.method === 'OPTIONS') {\n      return handleCORS(request);\n    }\n\n    // GET \u30EA\u30AF\u30A8\u30B9\u30C8\u306E\u307F\u8A31\u53EF\n    if (request.method !== 'GET') {\n      return new Response('Method not allowed', { status: 405 });\n    }\n\n    try {\n      const url = new URL(request.url);\n      const pathname = url.pathname;\n\n      // \u30A8\u30F3\u30C9\u30DD\u30A4\u30F3\u30C8\u5206\u5C90: /resolve-channel\n      if (pathname === '/resolve-channel') {\n        return await handleResolveChannel(request, env);\n      }\n\n      // \u65B0\u30A8\u30F3\u30C9\u30DD\u30A4\u30F3\u30C8: /fetch-videos\n      if (pathname === '/fetch-videos') {\n        return await handleFetchVideos(request, env);\n      }\n\n      // \u30C7\u30D5\u30A9\u30EB\u30C8: CORS Proxy\u6A5F\u80FD\uFF08YouTube RSS\u306E\u307F\uFF09\n      // URL\u30D1\u30E9\u30E1\u30FC\u30BF\u304B\u3089\u5BFE\u8C61URL\u3092\u53D6\u5F97\n      const targetUrl = url.searchParams.get('url');\n\n      // URL\u30D1\u30E9\u30E1\u30FC\u30BF\u306E\u30D0\u30EA\u30C7\u30FC\u30B7\u30E7\u30F3\n      if (!targetUrl) {\n        return createErrorResponse('Missing \"url\" parameter', 400, request);\n      }\n\n      // YouTube RSS URL\u306E\u691C\u8A3C\uFF08\u30BB\u30AD\u30E5\u30EA\u30C6\u30A3: \u30AA\u30FC\u30D7\u30F3\u30D7\u30ED\u30AD\u30B7\u9632\u6B62\uFF09\n      if (!YOUTUBE_RSS_PATTERN.test(targetUrl)) {\n        return createErrorResponse(\n          'Invalid URL. Only YouTube RSS feeds are allowed.',\n          403,\n          request\n        );\n      }\n\n      // YouTube RSS\u3092\u30D5\u30A7\u30C3\u30C1\uFF08Cloudflare Cache\u3092\u6709\u52B9\u5316\u30015\u5206\u9593\u30AD\u30E3\u30C3\u30B7\u30E5\uFF09\n      const response = await fetchWithTimeout(targetUrl, DEFAULT_TIMEOUT_MS, true, CACHE_TTL_SECONDS);\n\n      // \u30EC\u30B9\u30DD\u30F3\u30B9\u306E\u691C\u8A3C\n      if (!response.ok) {\n        return createErrorResponse(\n          `YouTube RSS fetch failed: ${response.status} ${response.statusText}`,\n          response.status,\n          request\n        );\n      }\n\n      // XML\u30C6\u30AD\u30B9\u30C8\u3092\u53D6\u5F97\n      const xmlText = await response.text();\n\n      // XML\u30D1\u30FC\u30B9\u30A8\u30E9\u30FC\u691C\u51FA\uFF08\u7C21\u6613\u30C1\u30A7\u30C3\u30AF\uFF09\n      if (!xmlText.includes('<?xml') || !xmlText.includes('<feed')) {\n        return createErrorResponse('Invalid XML response from YouTube', 502, request);\n      }\n\n      // \u6210\u529F\u30EC\u30B9\u30DD\u30F3\u30B9\u3092\u8FD4\u3059\n      const allowedOrigin = getAllowedOrigin(request);\n      return new Response(xmlText, {\n        status: 200,\n        headers: {\n          'Content-Type': 'application/xml; charset=utf-8',\n          'Access-Control-Allow-Origin': allowedOrigin || '*',\n          'Access-Control-Allow-Methods': 'GET, OPTIONS',\n          'Access-Control-Allow-Headers': 'Content-Type',\n          'Vary': 'Origin',\n          'X-Content-Type-Options': 'nosniff',\n          'Cache-Control': `public, max-age=${CACHE_TTL_SECONDS}`, // 5\u5206\u9593\u30AD\u30E3\u30C3\u30B7\u30E5\n          'X-Proxy-By': 'YouTube-List-Tool-Worker',\n        },\n      });\n\n    } catch (error) {\n      console.error('Worker error:', error);\n      return createErrorResponse(\n        `Proxy error: ${error && error.message ? error.message : String(error)}`,\n        500,\n        request\n      );\n    }\n  },\n};\n\n/**\n * /fetch-videos: YouTube Data API v3 \u304B\u3089\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u52D5\u753B\u3092\u6BB5\u968E\u7684\u306B\u53D6\u5F97\n *\n * \u30AF\u30A8\u30EA:\n * - channelId: UC\u3067\u59CB\u307E\u308B24\u6587\u5B57\uFF08\u5FC5\u9808\uFF09\n * - limit: 1\uFF5E50\uFF08\u30C7\u30D5\u30A9\u30EB\u30C850\uFF09\n * - startDate: YYYY-MM-DD\uFF08\u7701\u7565\u53EF\uFF09\n * - endDate: YYYY-MM-DD\uFF08\u7701\u7565\u53EF\uFF09\n * - pageToken: \u6B21\u30DA\u30FC\u30B8\u7528\u30C8\u30FC\u30AF\u30F3\uFF08\u7701\u7565\u53EF\uFF09\n *\n * \u4ED5\u69D8:\n * - 1\u56DE\u306E\u30EA\u30AF\u30A8\u30B9\u30C8\u3067\u6700\u592750\u4EF6\u8FD4\u5374\n * - \u5185\u90E8\u7684\u306B\u306F\u6700\u592710\u30DA\u30FC\u30B8\uFF08500\u4EF6\uFF09\u307E\u3067\u30B9\u30AD\u30E3\u30F3\n * - startDate/endDate \u306B\u3088\u308B\u65E9\u671F\u6253\u3061\u5207\u308A\n * - \u30BF\u30A4\u30E0\u30A2\u30A6\u30C8: 30\u79D2\uFF081\u30EA\u30AF\u30A8\u30B9\u30C8\u3042\u305F\u308A\uFF09\n * - \u30AD\u30E3\u30C3\u30B7\u30E5: 5\u5206\uFF08\u30D1\u30E9\u30E1\u30FC\u30BF\u5358\u4F4D\uFF09\n * - \u524A\u9664/\u975E\u516C\u958B\u52D5\u753B\u306F\u9664\u5916\n * - UC \u2192 UU \u3078\u306E\u5909\u63DB\u3067 uploads playlist \u3092\u76F4\u63A5\u53C2\u7167\n */\nasync function handleFetchVideos(request, env) {\n  const allowedOrigin = getAllowedOrigin(request);\n  const url = new URL(request.url);\n\n  // \u30AF\u30A8\u30EA\u53D6\u5F97\n  const channelId = url.searchParams.get('channelId') || '';\n  const limitRaw = url.searchParams.get('limit');\n  const startDateRaw = url.searchParams.get('startDate') || '';\n  const endDateRaw = url.searchParams.get('endDate') || '';\n  const pageTokenInitial = url.searchParams.get('pageToken') || '';\n\n  // \u5165\u529B\u30D0\u30EA\u30C7\u30FC\u30B7\u30E7\u30F3\n  if (!/^(UC)[0-9A-Za-z_-]{22}$/.test(channelId)) {\n    return jsonError(\n      {\n        code: ERROR_CODES.INVALID_CHANNEL_ID,\n        message: '\u30C1\u30E3\u30F3\u30CD\u30EBID\u306E\u5F62\u5F0F\u304C\u4E0D\u6B63\u3067\u3059\uFF08UC\u3067\u59CB\u307E\u308B24\u6587\u5B57\uFF09\u3002',\n      },\n      400,\n      allowedOrigin\n    );\n  }\n\n  const limit = clamp(Number.parseInt(limitRaw || '50', 10), 1, MAX_PAGE_RESULTS);\n\n  // \u65E5\u4ED8\u30D1\u30FC\u30B9\n  let startDate = null;\n  let endDate = null;\n  if (startDateRaw) {\n    startDate = parseISODateStart(startDateRaw);\n    if (!startDate) {\n      return jsonError(\n        { code: ERROR_CODES.BAD_REQUEST, message: 'startDate \u306E\u5F62\u5F0F\u304C\u4E0D\u6B63\u3067\u3059\uFF08YYYY-MM-DD\uFF09\u3002' },\n        400,\n        allowedOrigin\n      );\n    }\n  }\n  if (endDateRaw) {\n    endDate = parseISODateEnd(endDateRaw);\n    if (!endDate) {\n      return jsonError(\n        { code: ERROR_CODES.BAD_REQUEST, message: 'endDate \u306E\u5F62\u5F0F\u304C\u4E0D\u6B63\u3067\u3059\uFF08YYYY-MM-DD\uFF09\u3002' },\n        400,\n        allowedOrigin\n      );\n    }\n  }\n  if (startDate && endDate && startDate > endDate) {\n    return jsonError(\n      { code: ERROR_CODES.BAD_REQUEST, message: 'startDate \u306F endDate \u4EE5\u524D\u3067\u3042\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002' },\n      400,\n      allowedOrigin\n    );\n  }\n\n  // \u30AD\u30E3\u30C3\u30B7\u30E5\u30AD\u30FC\uFF08Query\u30D1\u30E9\u30E1\u30FC\u30BF\u3092\u6B63\u898F\u5316\u3057\u30665\u5206\u30AD\u30E3\u30C3\u30B7\u30E5\uFF09\n  const cacheKeyUrl = new URL('https://cache.youtubelisttool.local/fetch-videos');\n  cacheKeyUrl.searchParams.set('channelId', channelId);\n  cacheKeyUrl.searchParams.set('limit', String(limit));\n  if (startDateRaw) cacheKeyUrl.searchParams.set('startDate', startDateRaw);\n  if (endDateRaw) cacheKeyUrl.searchParams.set('endDate', endDateRaw);\n  if (pageTokenInitial) cacheKeyUrl.searchParams.set('pageToken', pageTokenInitial);\n  const cache = caches.default;\n  const cacheRequest = new Request(cacheKeyUrl.toString(), { method: 'GET' });\n\n  // Cache \u304B\u3089\u306E\u53D6\u5F97\n  const cached = await cache.match(cacheRequest);\n  if (cached) {\n    // CORS \u30D8\u30C3\u30C0\u30FC\u3092\u4ED8\u4E0E\u3057\u3066\u8FD4\u5374\n    const body = await cached.arrayBuffer();\n    const headers = new Headers(cached.headers);\n    headers.set('Access-Control-Allow-Origin', allowedOrigin || '*');\n    headers.set('Access-Control-Allow-Methods', 'GET, OPTIONS');\n    headers.set('Access-Control-Allow-Headers', 'Content-Type');\n    headers.set('Vary', 'Origin');\n    headers.set('X-Cache', 'HIT');\n    return new Response(body, { status: cached.status, headers });\n  }\n\n  // API\u30AD\u30FC\u53D6\u5F97\n  const apiKey = getYouTubeApiKey(env);\n  if (!apiKey) {\n    return jsonError(\n      { code: ERROR_CODES.INVALID_KEY, message: 'YouTube API \u30AD\u30FC\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002' },\n      401,\n      allowedOrigin\n    );\n  }\n\n  // \u30EC\u30FC\u30C8\u5236\u9650\uFF08Durable Object\uFF09\n  const clientKey = `fetch-videos:${getClientKey(request)}`;\n  const rateLimit = await checkRateLimit(env, clientKey, 60, 60_000); // 60req/\u5206\n  if (rateLimit.limited) {\n    return jsonError(\n      {\n        code: ERROR_CODES.RATE_LIMITED,\n        message: '\u30EA\u30AF\u30A8\u30B9\u30C8\u304C\u591A\u3059\u304E\u307E\u3059\u3002\u3057\u3070\u3089\u304F\u3057\u3066\u304B\u3089\u518D\u8A66\u884C\u3057\u3066\u304F\u3060\u3055\u3044\u3002',\n        retryAfterSec: rateLimit.retryAfterSec,\n      },\n      429,\n      allowedOrigin,\n      rateLimit.retryAfterSec\n    );\n  }\n\n  // UC \u2192 UU \u5909\u63DB\uFF08uploads playlist\uFF09\n  const uploadsPlaylistId = 'UU' + channelId.slice(2);\n\n  // \u30DA\u30FC\u30B8\u30F3\u30B0\u53D6\u5F97\n  let pageToken = pageTokenInitial;\n  let pageCount = 0;\n  let scannedTotal = 0;\n  let videos = [];\n  let nextPageTokenOut = '';\n  let partial = false;\n  let earlyStopByDate = false;\n\n  // \u6700\u592710\u30DA\u30FC\u30B8\u307E\u305F\u306F limit \u4EF6\u3092\u6E80\u305F\u3059\u307E\u3067\u7E70\u308A\u8FD4\u3057\n  while (pageCount < MAX_PAGES && videos.length < limit) {\n    pageCount++;\n\n    // YouTube Data API: playlistItems.list\n    const endpoint = '/playlistItems';\n    const params = new URLSearchParams();\n    params.set('part', 'snippet');\n    params.set('playlistId', uploadsPlaylistId);\n    params.set('maxResults', String(MAX_PAGE_RESULTS));\n    if (pageToken) params.set('pageToken', pageToken);\n    params.set('fields', 'items(snippet(title,publishedAt,resourceId/videoId)),nextPageToken');\n    params.set('prettyPrint', 'false');\n    params.set('key', apiKey);\n\n    const apiRes = await youtubeApiFetchJson(\n      endpoint,\n      params,\n      {\n        timeoutMs: FETCH_VIDEOS_TIMEOUT_MS,\n        maxRetries: 3,\n        request,\n        env,\n      }\n    );\n\n    if (apiRes.error) {\n      // \u30A8\u30E9\u30FC\u3092\u305D\u306E\u307E\u307E\u8FD4\u5374\uFF08\u7D71\u4E00\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8\uFF09\n      return jsonError(apiRes.error, apiRes.status || 500, allowedOrigin, apiRes.retryAfterSec);\n    }\n\n    const data = apiRes.data || {};\n    const items = Array.isArray(data.items) ? data.items : [];\n    scannedTotal += items.length;\n\n    // \u30A2\u30A4\u30C6\u30E0\u304C\u7A7A\u3067 nextPageToken \u3082\u7121\u3051\u308C\u3070\u7D42\u4E86\n    if (!items.length && !data.nextPageToken) {\n      nextPageTokenOut = '';\n      partial = false;\n      break;\n    }\n\n    // \u30DA\u30FC\u30B8\u5185\u306E\u9805\u76EE\u3092\u30D5\u30A3\u30EB\u30BF\uFF08\u524A\u9664/\u975E\u516C\u958B\u3001\u65E5\u4ED8\u30EC\u30F3\u30B8\uFF09\n    const pageVideos = [];\n    let pageOldestDate = null;\n\n    for (const it of items) {\n      const sn = it && it.snippet ? it.snippet : null;\n      if (!sn) continue;\n\n      const title = (sn.title || '').trim();\n      // \u524A\u9664/\u975E\u516C\u958B\u52D5\u753B\u3092\u9664\u5916\n      if (!sn.resourceId || !sn.resourceId.videoId) continue;\n      if (title === 'Deleted video' || title === 'Private video') continue;\n\n      const published = new Date(sn.publishedAt);\n      if (isNaN(published.getTime())) continue;\n\n      // \u30DA\u30FC\u30B8\u5185\u306E\u6700\u53E4\u65E5\u4ED8\u3092\u8A18\u9332\uFF08\u65E9\u671F\u6253\u3061\u5207\u308A\u5224\u5B9A\u306E\u305F\u3081\uFF09\n      if (!pageOldestDate || published < pageOldestDate) {\n        pageOldestDate = published;\n      }\n\n      // \u65E5\u4ED8\u30D5\u30A3\u30EB\u30BF\n      if (startDate && published < startDate) continue;\n      if (endDate && published > endDate) continue;\n\n      pageVideos.push({\n        url: `https://www.youtube.com/watch?v=${sn.resourceId.videoId}`,\n        title,\n        published: published.toISOString(),\n      });\n    }\n\n    // \u53CE\u96C6\n    for (const v of pageVideos) {\n      if (videos.length < limit) videos.push(v);\n    }\n\n    // \u65E9\u671F\u6253\u3061\u5207\u308A\uFF08startDate \u3088\u308A\u53E4\u3044\u3082\u306E\u3057\u304B\u6B8B\u3063\u3066\u3044\u306A\u3044\u3068\u5224\u65AD\u3067\u304D\u308B\u5834\u5408\uFF09\n    if (startDate && pageOldestDate && pageOldestDate < startDate) {\n      earlyStopByDate = true;\n    }\n\n    // \u6B21\u30DA\u30FC\u30B8\u5224\u5B9A\n    if (videos.length >= limit) {\n      // \u307E\u3060\u7D9A\u304D\u304C\u3042\u308B\n      nextPageTokenOut = data.nextPageToken || '';\n      partial = Boolean(nextPageTokenOut);\n      break;\n    } else if (data.nextPageToken && !earlyStopByDate) {\n      // \u6B21\u30DA\u30FC\u30B8\u3078\n      pageToken = data.nextPageToken;\n      nextPageTokenOut = pageToken; // \u3072\u3068\u307E\u305A\u4FDD\u6301\uFF08\u66F4\u65B0\u3055\u308C\u7D9A\u3051\u308B\uFF09\n      partial = true;\n      continue;\n    } else {\n      // \u6B21\u30DA\u30FC\u30B8\u306A\u3057\u3001\u307E\u305F\u306F\u65E5\u4ED8\u3067\u6253\u3061\u5207\u308A\n      nextPageTokenOut = '';\n      partial = false;\n      break;\n    }\n  }\n\n  // \u30C1\u30E3\u30F3\u30CD\u30EB\u540D\u3092\u53D6\u5F97\uFF08channels.list API\u547C\u3073\u51FA\u3057\uFF09\n  let channelTitle = '';\n  try {\n    const channelParams = new URLSearchParams();\n    channelParams.set('part', 'snippet');\n    channelParams.set('id', channelId);\n    channelParams.set('fields', 'items(snippet/title)');\n    channelParams.set('key', apiKey);\n\n    const channelRes = await youtubeApiFetchJson('/channels', channelParams, {\n      timeoutMs: 10000,\n      maxRetries: 2,\n      request,\n      env,\n    });\n\n    if (channelRes.data && channelRes.data.items && channelRes.data.items[0]) {\n      channelTitle = channelRes.data.items[0].snippet?.title || '';\n    }\n  } catch (e) {\n    // \u30C1\u30E3\u30F3\u30CD\u30EB\u540D\u53D6\u5F97\u5931\u6557\u6642\u306F\u7A7A\u6587\u5B57\u5217\u306E\u307E\u307E\u7D9A\u884C\n    console.warn('Failed to fetch channel title:', e);\n  }\n\n  // \u30EC\u30B9\u30DD\u30F3\u30B9\u69CB\u7BC9\n  const payload = {\n    ok: true,\n    channelId,\n    channelTitle,\n    count: videos.length,\n    totalFetched: scannedTotal,\n    partial,\n    nextPageToken: partial ? nextPageTokenOut : '',\n    videos,\n  };\n\n  // \u30AD\u30E3\u30C3\u30B7\u30E5\u306B\u4FDD\u5B58\uFF085\u5206\uFF09\n  const jsonText = JSON.stringify(payload);\n  const headers = {\n    'Content-Type': 'application/json; charset=utf-8',\n    'Access-Control-Allow-Origin': allowedOrigin || '*',\n    'Access-Control-Allow-Methods': 'GET, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type',\n    'Vary': 'Origin',\n    'Cache-Control': `public, max-age=${CACHE_TTL_SECONDS}`,\n    'X-Cache': 'MISS',\n  };\n  const response = new Response(jsonText, { status: 200, headers });\n\n  try {\n    await cache.put(\n      cacheRequest,\n      new Response(jsonText, {\n        status: 200,\n        headers: {\n          'Content-Type': 'application/json; charset=utf-8',\n          'Cache-Control': `public, max-age=${CACHE_TTL_SECONDS}`,\n        },\n      })\n    );\n  } catch (e) {\n    // \u30AD\u30E3\u30C3\u30B7\u30E5\u66F8\u304D\u8FBC\u307F\u5931\u6557\u306F\u7121\u8996\uFF08\u30ED\u30B0\u306E\u307F\uFF09\n    console.warn('Cache put failed for /fetch-videos:', e && e.message ? e.message : e);\n  }\n\n  return response;\n}\n\n/**\n * /resolve-channel: @handle \u2192 channelId \u5909\u63DB\n *\n * \u5165\u529B:\n * - handle: \"@foobar\" / \"foobar\" / \"https://www.youtube.com/@foobar\"\n * - \u307E\u305F\u306F q / url \u306A\u3069\u8907\u6570\u30A8\u30A4\u30EA\u30A2\u30B9\u306B\u5BFE\u5FDC\n * - \u65E2\u306B channelId(UC...) \u306E\u5834\u5408\u306F\u691C\u8A3C\u3057\u3066\u305D\u306E\u307E\u307E\u8FD4\u3059\n *\n * \u5B9F\u88C5:\n * - YouTube Data API channels.list (forHandle) \u3092\u4F7F\u7528\n * - fields \u3067\u6700\u5C0F\u9650\u306B\u7D5E\u308A\u3001Cache API \u3067 5 \u5206\u30AD\u30E3\u30C3\u30B7\u30E5\n */\nasync function handleResolveChannel(request, env) {\n  const allowedOrigin = getAllowedOrigin(request);\n  const url = new URL(request.url);\n\n  const raw =\n    url.searchParams.get('handle') ||\n    url.searchParams.get('q') ||\n    url.searchParams.get('url') ||\n    url.searchParams.get('id') ||\n    '';\n\n  if (!raw) {\n    return jsonError(\n      { code: ERROR_CODES.BAD_REQUEST, message: 'handle\uFF08@\u30CF\u30F3\u30C9\u30EB\u540D\uFF09\u307E\u305F\u306F URL \u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002' },\n      400,\n      allowedOrigin\n    );\n  }\n\n  // \u65E2\u306B UC \u5F62\u5F0F\u306A\u3089\u691C\u8A3C\u3057\u3066\u305D\u306E\u307E\u307E\u8FD4\u5374\n  const ucCandidate = extractChannelId(raw);\n  if (ucCandidate) {\n    return jsonOk(\n      {\n        ok: true,\n        input: raw,\n        channelId: ucCandidate,\n      },\n      allowedOrigin\n    );\n  }\n\n  // @handle \u3092\u62BD\u51FA\n  const handle = extractHandle(raw);\n  if (!handle) {\n    return jsonError(\n      { code: ERROR_CODES.BAD_REQUEST, message: '\u6709\u52B9\u306A @\u30CF\u30F3\u30C9\u30EB \u3092\u62BD\u51FA\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002' },\n      400,\n      allowedOrigin\n    );\n  }\n\n  // \u30AD\u30E3\u30C3\u30B7\u30E5\u30AD\u30FC\n  const cacheKeyUrl = new URL('https://cache.youtubelisttool.local/resolve-channel');\n  cacheKeyUrl.searchParams.set('handle', handle);\n  const cache = caches.default;\n  const cacheRequest = new Request(cacheKeyUrl.toString(), { method: 'GET' });\n\n  const cached = await cache.match(cacheRequest);\n  if (cached) {\n    const body = await cached.arrayBuffer();\n    const headers = new Headers(cached.headers);\n    headers.set('Access-Control-Allow-Origin', allowedOrigin || '*');\n    headers.set('Access-Control-Allow-Methods', 'GET, OPTIONS');\n    headers.set('Access-Control-Allow-Headers', 'Content-Type');\n    headers.set('Vary', 'Origin');\n    headers.set('X-Cache', 'HIT');\n    return new Response(body, { status: cached.status, headers });\n  }\n\n  // API\u30AD\u30FC\n  const apiKey = getYouTubeApiKey(env);\n  if (!apiKey) {\n    return jsonError(\n      { code: ERROR_CODES.INVALID_KEY, message: 'YouTube API \u30AD\u30FC\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002' },\n      401,\n      allowedOrigin\n    );\n  }\n\n  // \u30EC\u30FC\u30C8\u5236\u9650\uFF08Durable Object\uFF09\n  const clientKey = `resolve-channel:${getClientKey(request)}`;\n  const rateLimit = await checkRateLimit(env, clientKey, 120, 60_000); // 120req/\u5206\n  if (rateLimit.limited) {\n    return jsonError(\n      {\n        code: ERROR_CODES.RATE_LIMITED,\n        message: '\u30EA\u30AF\u30A8\u30B9\u30C8\u304C\u591A\u3059\u304E\u307E\u3059\u3002\u3057\u3070\u3089\u304F\u3057\u3066\u304B\u3089\u518D\u8A66\u884C\u3057\u3066\u304F\u3060\u3055\u3044\u3002',\n        retryAfterSec: rateLimit.retryAfterSec,\n      },\n      429,\n      allowedOrigin,\n      rateLimit.retryAfterSec\n    );\n  }\n\n  // YouTube Data API: channels.list (forHandle)\n  const endpoint = '/channels';\n  const params = new URLSearchParams();\n  params.set('part', 'id');\n  params.set('forHandle', handle.startsWith('@') ? handle : `@${handle}`);\n  params.set('fields', 'items(id)');\n  params.set('prettyPrint', 'false');\n  params.set('key', apiKey);\n\n  const apiRes = await youtubeApiFetchJson(\n    endpoint,\n    params,\n    {\n      timeoutMs: 15_000,\n      maxRetries: 3,\n      request,\n      env,\n    }\n  );\n\n  if (apiRes.error) {\n    return jsonError(apiRes.error, apiRes.status || 500, allowedOrigin, apiRes.retryAfterSec);\n  }\n\n  const data = apiRes.data || {};\n  const items = Array.isArray(data.items) ? data.items : [];\n  if (!items.length || !items[0] || !items[0].id) {\n    return jsonError({ code: ERROR_CODES.NOT_FOUND, message: '\u30C1\u30E3\u30F3\u30CD\u30EB\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3067\u3057\u305F\u3002' }, 404, allowedOrigin);\n  }\n  const channelId = items[0].id;\n\n  const respPayload = {\n    ok: true,\n    input: raw,\n    channelId,\n  };\n  const jsonText = JSON.stringify(respPayload);\n  const response = new Response(jsonText, {\n    status: 200,\n    headers: {\n      'Content-Type': 'application/json; charset=utf-8',\n      'Access-Control-Allow-Origin': allowedOrigin || '*',\n      'Access-Control-Allow-Methods': 'GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n      'Vary': 'Origin',\n      'Cache-Control': `public, max-age=${CACHE_TTL_SECONDS}`,\n      'X-Cache': 'MISS',\n    },\n  });\n\n  try {\n    await cache.put(\n      cacheRequest,\n      new Response(jsonText, {\n        status: 200,\n        headers: {\n          'Content-Type': 'application/json; charset=utf-8',\n          'Cache-Control': `public, max-age=${CACHE_TTL_SECONDS}`,\n        },\n      })\n    );\n  } catch (e) {\n    console.warn('Cache put failed for /resolve-channel:', e && e.message ? e.message : e);\n  }\n\n  return response;\n}\n\n/**\n * CORS \u30D7\u30EA\u30D5\u30E9\u30A4\u30C8\u306E\u51E6\u7406\n */\nfunction handleCORS(request) {\n  const allowedOrigin = getAllowedOrigin(request);\n  return new Response(null, {\n    status: 204,\n    headers: {\n      'Access-Control-Allow-Origin': allowedOrigin || '*',\n      'Access-Control-Allow-Methods': 'GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n      'Access-Control-Max-Age': '86400',\n      'Vary': 'Origin',\n    },\n  });\n}\n\n/**\n * \u8A31\u53EF\u3055\u308C\u305F\u30AA\u30EA\u30B8\u30F3\u304B\u3069\u3046\u304B\u3092\u5224\u5B9A\n */\nfunction isOriginAllowed(origin) {\n  if (!origin) return false;\n  if (ALLOWED_ORIGINS.includes(origin)) return true;\n  if (PREVIEW_ORIGIN_REGEX.test(origin)) return true;\n  return false;\n}\n\n/**\n * \u30EC\u30B9\u30DD\u30F3\u30B9\u7528\u306B\u8A31\u53EF\u30AA\u30EA\u30B8\u30F3\u3092\u53D6\u5F97\n */\nfunction getAllowedOrigin(request) {\n  const origin = request.headers.get('Origin');\n  if (origin && isOriginAllowed(origin)) return origin;\n  return '';\n}\n\n/**\n * \u65E2\u5B58\u306E\u30D7\u30ED\u30AD\u30B7\u7528\u30A8\u30E9\u30FC\u30EC\u30B9\u30DD\u30F3\u30B9\uFF08\u30C6\u30AD\u30B9\u30C8\uFF09\n */\nfunction createErrorResponse(message, status = 500, request) {\n  const allowedOrigin = getAllowedOrigin(request);\n  return new Response(message, {\n    status,\n    headers: {\n      'Content-Type': 'text/plain; charset=utf-8',\n      'Access-Control-Allow-Origin': allowedOrigin || '*',\n      'Access-Control-Allow-Methods': 'GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n      'Vary': 'Origin',\n      'X-Content-Type-Options': 'nosniff',\n    },\n  });\n}\n\n/**\n * JSON \u30A8\u30E9\u30FC\u306E\u7D71\u4E00\u30EC\u30B9\u30DD\u30F3\u30B9\n */\nfunction jsonError(errorObj, status = 500, allowedOrigin = '', retryAfterSec) {\n  const body = JSON.stringify({ ok: false, ...errorObj });\n  const headers = {\n    'Content-Type': 'application/json; charset=utf-8',\n    'Access-Control-Allow-Origin': allowedOrigin || '*',\n    'Access-Control-Allow-Methods': 'GET, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type',\n    'Vary': 'Origin',\n    'Cache-Control': 'no-store',\n  };\n  if (retryAfterSec && Number.isFinite(retryAfterSec)) {\n    headers['Retry-After'] = String(Math.max(0, Math.floor(retryAfterSec)));\n  }\n  return new Response(body, { status, headers });\n}\n\n/**\n * JSON OK \u30EC\u30B9\u30DD\u30F3\u30B9\n */\nfunction jsonOk(payload, allowedOrigin = '') {\n  const body = JSON.stringify(payload);\n  return new Response(body, {\n    status: 200,\n    headers: {\n      'Content-Type': 'application/json; charset=utf-8',\n      'Access-Control-Allow-Origin': allowedOrigin || '*',\n      'Access-Control-Allow-Methods': 'GET, OPTIONS',\n      'Access-Control-Allow-Headers': 'Content-Type',\n      'Vary': 'Origin',\n      'Cache-Control': `public, max-age=${CACHE_TTL_SECONDS}`,\n    },\n  });\n}\n\n/**\n * \u30D5\u30A7\u30C3\u30C1\uFF08\u30AA\u30D7\u30B7\u30E7\u30F3\u3067 Cache API \u3092\u4F7F\u7528\uFF09+ \u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\n *\n * useCache: true \u306E\u3068\u304D Cache API \u306B 5 \u5206\u4FDD\u5B58\uFF08TTL \u306F\u5F15\u6570\uFF09\n * \u6CE8\u610F: Cache API \u306F Request/Response \u306E Cache-Control \u3092\u5C0A\u91CD\n */\nasync function fetchWithTimeout(input, timeoutMs = DEFAULT_TIMEOUT_MS, useCache = false, cacheTtlSec = CACHE_TTL_SECONDS, extraInit = {}) {\n  const controller = new AbortController();\n  const id = setTimeout(() => controller.abort('timeout'), timeoutMs);\n\n  try {\n    const req = input instanceof Request\n      ? input\n      : new Request(String(input), {\n          method: 'GET',\n          headers: {\n            'User-Agent': USER_AGENT,\n          },\n          ...extraInit,\n          signal: controller.signal,\n        });\n\n    if (!useCache) {\n      const res = await fetch(req, { signal: controller.signal });\n      return res;\n    }\n\n    // Cache API\n    const cache = caches.default;\n    const cacheKey = new Request(req.url, { method: 'GET' });\n    const cached = await cache.match(cacheKey);\n    if (cached) return cached;\n\n    const res = await fetch(req, { signal: controller.signal });\n    if (res.ok) {\n      const headers = new Headers(res.headers);\n      headers.set('Cache-Control', `public, max-age=${cacheTtlSec}`);\n      const cacheable = new Response(res.body, {\n        status: res.status,\n        headers,\n      });\n      try {\n        await cache.put(cacheKey, cacheable.clone());\n      } catch (e) {\n        console.warn('Cache put failed:', e && e.message ? e.message : e);\n      }\n      return cacheable;\n    }\n    return res;\n  } catch (err) {\n    if (err && String(err).includes('timeout')) {\n      const res = new Response('Upstream timeout', { status: 504 });\n      return res;\n    }\n    throw err;\n  } finally {\n    clearTimeout(id);\n  }\n}\n\n/**\n * YouTube API \u7528\u306E fetch \u30E9\u30C3\u30D1\u30FC\n * - \u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\n * - \u6307\u6570\u30D0\u30C3\u30AF\u30AA\u30D5 + \u30EA\u30C8\u30E9\u30A4\uFF08\u6700\u59273\u56DE\uFF09\n * - Retry-After \u3092\u5C0A\u91CD\n * - \u30A8\u30E9\u30FC\u30DE\u30C3\u30D4\u30F3\u30B0\uFF08\u7D71\u4E00\u30B3\u30FC\u30C9\uFF09\n * - 429/5xx/\u4E00\u90E8403\uFF08rateLimitExceeded\uFF09\u306F\u518D\u8A66\u884C\n * - 403\uFF08quotaExceeded\uFF09\u306F\u5373\u6642\u30A8\u30E9\u30FC\n * - 401/400/404 \u306F\u5373\u6642\u30A8\u30E9\u30FC\n */\nasync function youtubeApiFetchJson(endpoint, params, { timeoutMs, maxRetries, request, env }) {\n  const url = new URL(YT_API_BASE + endpoint);\n  for (const [k, v] of params.entries()) url.searchParams.set(k, v);\n\n  let attempt = 0;\n  let waitMs = 500;\n\n  while (attempt <= maxRetries) {\n    attempt++;\n\n    try {\n      const res = await fetchWithTimeout(\n        new Request(url.toString(), {\n          headers: {\n            'User-Agent': USER_AGENT,\n          },\n        }),\n        timeoutMs,\n        false\n      );\n\n      // \u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u306F fetchWithTimeout \u304C 504 \u3067\u8FD4\u3057\u5F97\u308B\n      if (res.status === 504) {\n        if (attempt <= maxRetries) {\n          await sleep(waitMs);\n          waitMs *= 2;\n          continue;\n        }\n        return {\n          error: { code: ERROR_CODES.TIMEOUT, message: 'YouTube API \u306E\u5FDC\u7B54\u304C\u30BF\u30A4\u30E0\u30A2\u30A6\u30C8\u3057\u307E\u3057\u305F\u3002' },\n          status: 504,\n        };\n      }\n\n      // OK\n      if (res.ok) {\n        let data = null;\n        try {\n          data = await res.json();\n        } catch {\n          data = {};\n        }\n        return { data, status: res.status };\n      }\n\n      // \u30A8\u30E9\u30FC\u89E3\u6790\n      const text = await res.text();\n      const errInfo = parseYouTubeApiError(text) || {};\n      const reason = errInfo.reason || '';\n      const message = errInfo.message || `YouTube API error: ${res.status}`;\n\n      // \u518D\u8A66\u884C\u6761\u4EF6\n      if (res.status === 429) {\n        const retryAfterSec = parseRetryAfter(res.headers.get('Retry-After')) || Math.ceil(waitMs / 1000);\n        if (attempt <= maxRetries) {\n          await sleep(retryAfterSec * 1000);\n          continue;\n        }\n        return {\n          error: { code: ERROR_CODES.RATE_LIMITED, message: 'YouTube API \u306E\u30EC\u30FC\u30C8\u5236\u9650\u306B\u9054\u3057\u307E\u3057\u305F\u3002', retryAfterSec },\n          status: 429,\n          retryAfterSec,\n        };\n      }\n\n      if (res.status >= 500 && res.status < 600) {\n        if (attempt <= maxRetries) {\n          await sleep(waitMs);\n          waitMs *= 2;\n          continue;\n        }\n        return {\n          error: { code: ERROR_CODES.BAD_REQUEST, message: 'YouTube API \u3067\u30B5\u30FC\u30D0\u30FC\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F\u3002' },\n          status: res.status,\n        };\n      }\n\n      if (res.status === 403) {\n        if (reason === 'quotaExceeded' || reason === 'dailyLimitExceeded') {\n          return {\n            error: { code: ERROR_CODES.QUOTA_EXCEEDED, message: 'YouTube API \u306E\u30AF\u30A9\u30FC\u30BF\u3092\u8D85\u904E\u3057\u307E\u3057\u305F\u3002' },\n            status: 403,\n          };\n        }\n        if (reason === 'rateLimitExceeded' || reason === 'userRateLimitExceeded') {\n          // \u518D\u8A66\u884C\u5BFE\u8C61\n          if (attempt <= maxRetries) {\n            await sleep(waitMs);\n            waitMs *= 2;\n            continue;\n          }\n          return {\n            error: { code: ERROR_CODES.RATE_LIMITED, message: 'YouTube API \u306E\u30EC\u30FC\u30C8\u5236\u9650\u306B\u9054\u3057\u307E\u3057\u305F\u3002' },\n            status: 429,\n          };\n        }\n        return {\n          error: { code: ERROR_CODES.BAD_REQUEST, message: message || '\u30A2\u30AF\u30BB\u30B9\u304C\u62D2\u5426\u3055\u308C\u307E\u3057\u305F\u3002' },\n          status: 403,\n        };\n      }\n\n      if (res.status === 401) {\n        return { error: { code: ERROR_CODES.INVALID_KEY, message: 'YouTube API \u30AD\u30FC\u304C\u7121\u52B9\u3067\u3059\u3002' }, status: 401 };\n      }\n\n      if (res.status === 404) {\n        return { error: { code: ERROR_CODES.NOT_FOUND, message: '\u5BFE\u8C61\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3067\u3057\u305F\u3002' }, status: 404 };\n      }\n\n      if (res.status === 400) {\n        // \u7121\u52B9\u306A\u30D1\u30E9\u30E1\u30FC\u30BF\u7B49\uFF08playlistId \u7121\u52B9\u306A\u3069\uFF09\n        return {\n          error: {\n            code: ERROR_CODES.BAD_REQUEST,\n            message: message || '\u4E0D\u6B63\u306A\u30EA\u30AF\u30A8\u30B9\u30C8\u3067\u3059\u3002',\n          },\n          status: 400,\n        };\n      }\n\n      // \u305D\u306E\u4ED6\n      return { error: { code: ERROR_CODES.BAD_REQUEST, message: message }, status: res.status };\n    } catch (e) {\n      // \u30CD\u30C3\u30C8\u30EF\u30FC\u30AF\u4F8B\u5916\u7B49\n      if (attempt <= maxRetries) {\n        await sleep(waitMs);\n        waitMs *= 2;\n        continue;\n      }\n      return {\n        error: { code: ERROR_CODES.BAD_REQUEST, message: 'YouTube API \u306E\u547C\u3073\u51FA\u3057\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002' },\n        status: 502,\n      };\n    }\n  }\n\n  return {\n    error: { code: ERROR_CODES.BAD_REQUEST, message: 'YouTube API \u306E\u547C\u3073\u51FA\u3057\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002' },\n    status: 502,\n  };\n}\n\n/**\n * Durable Object \u306B\u3088\u308B\u30EC\u30FC\u30C8\u5236\u9650\u30C1\u30A7\u30C3\u30AF\n * - key: \u8B58\u5225\u5B50\uFF08IP\u7B49\uFF09\n * - limit: \u8A31\u5BB9\u56DE\u6570\n * - windowMs: \u7A93\u671F\u9593\uFF08\u30DF\u30EA\u79D2\uFF09\n */\nasync function checkRateLimit(env, key, limit, windowMs) {\n  try {\n    if (!env || !env.RATE_LIMITER) {\n      // DO \u672A\u30D0\u30A4\u30F3\u30C9\u6642\u306F\u5E38\u306B\u8A31\u53EF\uFF08\u958B\u767A\u7528\u9014\uFF09\n      return { limited: false, remaining: Number.MAX_SAFE_INTEGER, retryAfterSec: 0 };\n    }\n    const id = env.RATE_LIMITER.idFromName(key);\n    const stub = env.RATE_LIMITER.get(id);\n    const resp = await stub.fetch(`http://limit/?key=${encodeURIComponent(key)}&limit=${limit}&windowMs=${windowMs}`);\n    const data = await resp.json();\n    return {\n      limited: !!data.limited,\n      remaining: typeof data.remaining === 'number' ? data.remaining : 0,\n      retryAfterSec: typeof data.retryAfterSec === 'number' ? data.retryAfterSec : 0,\n    };\n  } catch (e) {\n    // \u5931\u6557\u3057\u305F\u5834\u5408\u306F fail-open\n    console.warn('RateLimiter check failed:', e && e.message ? e.message : e);\n    return { limited: false, remaining: Number.MAX_SAFE_INTEGER, retryAfterSec: 0 };\n  }\n}\n\n/**\n * YouTube API \u30A8\u30E9\u30FC\u672C\u6587\u306E\u7C21\u6613\u30D1\u30FC\u30B9\n * - RFC7807 \u98A8 or Google API \u5F62\u5F0F\u306B\u5BFE\u5FDC\n */\nfunction parseYouTubeApiError(text) {\n  try {\n    const obj = JSON.parse(text);\n    if (obj && obj.error) {\n      // Google APIs \u6A19\u6E96\n      const e = obj.error;\n      if (Array.isArray(e.errors) && e.errors[0]) {\n        return { message: e.message || '', reason: e.errors[0].reason || '' };\n      }\n      if (e.status && e.message) {\n        // \u65B0\u3057\u3044\u30A8\u30E9\u30FC\u30D5\u30A9\u30FC\u30DE\u30C3\u30C8\n        // details[].errors[].reason \u306E\u3053\u3068\u3082\u3042\u308B\u304C\u6700\u4F4E\u9650\u89E3\u6790\n        const reason =\n          (Array.isArray(e.details) &&\n            e.details.find((d) => Array.isArray(d.errors) && d.errors[0] && d.errors[0].reason)?.errors?.[0]?.reason) ||\n          '';\n        return { message: e.message, reason };\n      }\n      return { message: e.message || 'YouTube API error', reason: '' };\n    }\n  } catch {\n    // ignore\n  }\n  return null;\n}\n\n/**\n * Retry-After \u3092\u79D2\u306B\u30D1\u30FC\u30B9\n */\nfunction parseRetryAfter(v) {\n  if (!v) return 0;\n  const sec = Number.parseInt(v, 10);\n  if (Number.isFinite(sec)) return Math.max(0, sec);\n  const date = new Date(v);\n  if (!isNaN(date.getTime())) {\n    const now = Date.now();\n    return Math.max(0, Math.ceil((date.getTime() - now) / 1000));\n  }\n  return 0;\n}\n\n/**\n * \u30D8\u30EB\u30D1\u30FC: sleep\n */\nfunction sleep(ms) {\n  return new Promise((r) => setTimeout(r, ms));\n}\n\n/**\n * clamp\n */\nfunction clamp(n, min, max) {\n  if (!Number.isFinite(n)) return min;\n  return Math.min(Math.max(n, min), max);\n}\n\n/**\n * YYYY-MM-DD \u2192 Date(UTC start-of-day)\n */\nfunction parseISODateStart(s) {\n  if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(s)) return null;\n  const d = new Date(`${s}T00:00:00.000Z`);\n  if (isNaN(d.getTime())) return null;\n  return d;\n}\n\n/**\n * YYYY-MM-DD \u2192 Date(UTC end-of-day)\n */\nfunction parseISODateEnd(s) {\n  if (!/^\\d{4}-\\d{2}-\\d{2}$/.test(s)) return null;\n  const d = new Date(`${s}T23:59:59.999Z`);\n  if (isNaN(d.getTime())) return null;\n  return d;\n}\n\n/**\n * \u5165\u529B\u304B\u3089 @handle \u3092\u62BD\u51FA\n */\nfunction extractHandle(raw) {\n  const s = String(raw).trim();\n  // URL \u306E\u5834\u5408\n  try {\n    const u = new URL(s);\n    // /@handle or /handle\n    const m = u.pathname.match(/\\/@?([^/]+)/);\n    if (m && m[1]) {\n      return m[0].startsWith('/@') ? `@${m[1]}` : `@${m[1]}`;\n    }\n  } catch {\n    // ignore\n  }\n  // @\u4ED8\u304D or \u30D7\u30EC\u30FC\u30F3\u6587\u5B57\u5217\n  if (s.startsWith('@')) return s;\n  if (/^[A-Za-z0-9._-]+$/.test(s)) return `@${s}`;\n  return '';\n}\n\n/**\n * \u5165\u529B\u304B\u3089 UC \u30C1\u30E3\u30F3\u30CD\u30EBID\u3092\u62BD\u51FA\uFF08\u898B\u3064\u304B\u3089\u306A\u3051\u308C\u3070\u7A7A\u6587\u5B57\uFF09\n */\nfunction extractChannelId(raw) {\n  const s = String(raw).trim();\n  // \u305D\u306E\u307E\u307E UC... \u5F62\u5F0F\u304B\uFF1F\n  if (/^(UC)[0-9A-Za-z_-]{22}$/.test(s)) return s;\n  // URL \u5185\u306B\u542B\u307E\u308C\u308B\u304B\uFF1F\n  try {\n    const u = new URL(s);\n    const qId = u.searchParams.get('channel') || u.searchParams.get('channel_id');\n    if (qId && /^(UC)[0-9A-Za-z_-]{22}$/.test(qId)) return qId;\n    // /channel/UCxxxx\n    const m = u.pathname.match(/\\/channel\\/(UC[0-9A-Za-z_-]{22})/);\n    if (m && m[1]) return m[1];\n  } catch {\n    // ignore\n  }\n  return '';\n}\n\n/**\n * \u30AF\u30E9\u30A4\u30A2\u30F3\u30C8\u8B58\u5225\u30AD\u30FC\uFF08IP\u30D9\u30FC\u30B9 + Origin\uFF09\n */\nfunction getClientKey(request) {\n  const ip = request.headers.get('CF-Connecting-IP') ||\n             request.headers.get('X-Forwarded-For') ||\n             'unknown';\n  const origin = request.headers.get('Origin') || '';\n  return `${ip}:${origin}`;\n}\n\n/**\n * YouTube API \u30AD\u30FC\u3092\u53D6\u5F97\n */\nfunction getYouTubeApiKey(env) {\n  return env && (env.YT_API_KEY || env.YOUTUBE_API_KEY || env.GOOGLE_API_KEY);\n}\n\n/**\n * Durable Object: RateLimiter\n *\n * \u30B7\u30F3\u30D7\u30EB\u306A\u56FA\u5B9A\u30A6\u30A3\u30F3\u30C9\u30A6\u30AB\u30A6\u30F3\u30BF\u65B9\u5F0F\n * - key: \u8B58\u5225\u5B50\uFF08IP\u7B49\uFF09\n * - limit: \u8A31\u5BB9\u56DE\u6570\n * - windowMs: \u7A93\u671F\u9593\uFF08\u30DF\u30EA\u79D2\uFF09\n *\n * \u30B9\u30C8\u30EC\u30FC\u30B8\u306B { windowStart: number, count: number } \u3092\u4FDD\u5B58\n */\nexport class RateLimiter {\n  constructor(state, env) {\n    this.state = state;\n    this.env = env;\n  }\n\n  async fetch(request) {\n    try {\n      const url = new URL(request.url);\n\n      const key = url.searchParams.get('key') || 'global';\n      const limit = clamp(Number.parseInt(url.searchParams.get('limit') || '60', 10), 1, 100000);\n      const windowMs = clamp(Number.parseInt(url.searchParams.get('windowMs') || '60000', 10), 100, 86_400_000);\n\n      const now = Date.now();\n      const storageKey = `rl:${key}`;\n      let data = await this.state.storage.get(storageKey);\n\n      if (!data || typeof data !== 'object') {\n        data = { windowStart: now, count: 0 };\n      }\n\n      let { windowStart, count } = data;\n\n      // \u30A6\u30A3\u30F3\u30C9\u30A6\u66F4\u65B0\n      if (now - windowStart >= windowMs) {\n        windowStart = now;\n        count = 0;\n      }\n\n      // \u30A4\u30F3\u30AF\u30EA\u30E1\u30F3\u30C8\n      count += 1;\n\n      // \u4FDD\u5B58\n      await this.state.storage.put(storageKey, { windowStart, count });\n\n      // \u5224\u5B9A\n      let limited = false;\n      let retryAfterSec = 0;\n      if (count > limit) {\n        limited = true;\n        const resetInMs = windowMs - (now - windowStart);\n        retryAfterSec = Math.max(0, Math.ceil(resetInMs / 1000));\n      }\n\n      const remaining = Math.max(0, limit - count);\n\n      return new Response(\n        JSON.stringify({ limited, remaining, retryAfterSec }),\n        {\n          status: 200,\n          headers: {\n            'Content-Type': 'application/json; charset=utf-8',\n            'Cache-Control': 'no-store',\n          },\n        }\n      );\n    } catch (e) {\n      return new Response(\n        JSON.stringify({\n          limited: false,\n          remaining: 0,\n          retryAfterSec: 0,\n          error: String(e && e.message ? e.message : e),\n        }),\n        { status: 200, headers: { 'Content-Type': 'application/json; charset=utf-8' } }\n      );\n    }\n  }\n}\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/mnt/c/Users/littl/app-dev/05_YouTubeListTool/YouTubeListTool/workers/youtube-proxy.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/home/littl/.nvm/versions/node/v22.19.0/lib/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/home/littl/.nvm/versions/node/v22.19.0/lib/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/mnt/c/Users/littl/app-dev/05_YouTubeListTool/YouTubeListTool/workers/youtube-proxy.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/mnt/c/Users/littl/app-dev/05_YouTubeListTool/YouTubeListTool/.wrangler/tmp/bundle-tMlVQF/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/home/littl/.nvm/versions/node/v22.19.0/lib/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/mnt/c/Users/littl/app-dev/05_YouTubeListTool/YouTubeListTool/.wrangler/tmp/bundle-tMlVQF/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/mnt/c/Users/littl/app-dev/05_YouTubeListTool/YouTubeListTool/.wrangler/tmp/bundle-tMlVQF/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": ";;;;AAAA,IAAM,OAAO,oBAAI,IAAI;AAErB,SAAS,SAAS,SAAS,MAAM;AAChC,QAAM,MACL,mBAAmB,MAChB,UACA,IAAI;AAAA,KACH,OAAO,YAAY,WACjB,IAAI,QAAQ,SAAS,IAAI,IACzB,SACD;AAAA,EACH;AACH,MAAI,IAAI,QAAQ,IAAI,SAAS,SAAS,IAAI,aAAa,UAAU;AAChE,QAAI,CAAC,KAAK,IAAI,IAAI,SAAS,CAAC,GAAG;AAC9B,WAAK,IAAI,IAAI,SAAS,CAAC;AACvB,cAAQ;AAAA,QACP;AAAA,KACO,IAAI,SAAS,CAAC;AAAA;AAAA,MACtB;AAAA,IACD;AAAA,EACD;AACD;AAnBS;AAqBT,WAAW,QAAQ,IAAI,MAAM,WAAW,OAAO;AAAA,EAC9C,MAAM,QAAQ,SAAS,UAAU;AAChC,UAAM,CAAC,SAAS,IAAI,IAAI;AACxB,aAAS,SAAS,IAAI;AACtB,WAAO,QAAQ,MAAM,QAAQ,SAAS,QAAQ;AAAA,EAC/C;AACD,CAAC;;;ACVD,IAAM,kBAAkB;AAAA,EACtB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AACF;AAGA,IAAM,uBAAuB;AAG7B,IAAM,sBAAsB;AAG5B,IAAM,cAAc;AAGpB,IAAM,qBAAqB;AAC3B,IAAM,0BAA0B;AAChC,IAAM,mBAAmB;AACzB,IAAM,YAAY;AAClB,IAAM,oBAAoB;AAC1B,IAAM,aAAa;AAGnB,IAAM,cAAc;AAAA,EAClB,gBAAgB;AAAA;AAAA,EAChB,cAAc;AAAA;AAAA,EACd,aAAa;AAAA;AAAA,EACb,WAAW;AAAA;AAAA,EACX,oBAAoB;AAAA;AAAA,EACpB,aAAa;AAAA;AAAA,EACb,SAAS;AAAA;AACX;AAKA,IAAO,wBAAQ;AAAA,EACb,MAAM,MAAM,SAAS,KAAK,KAAK;AAE7B,UAAM,SAAS,QAAQ,QAAQ,IAAI,QAAQ;AAC3C,QAAI,UAAU,CAAC,gBAAgB,MAAM,GAAG;AACtC,aAAO,IAAI,SAAS,iCAAiC;AAAA,QACnD,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,gBAAgB;AAAA,QAClB;AAAA,MACF,CAAC;AAAA,IACH;AAGA,QAAI,QAAQ,WAAW,WAAW;AAChC,aAAO,WAAW,OAAO;AAAA,IAC3B;AAGA,QAAI,QAAQ,WAAW,OAAO;AAC5B,aAAO,IAAI,SAAS,sBAAsB,EAAE,QAAQ,IAAI,CAAC;AAAA,IAC3D;AAEA,QAAI;AACF,YAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAC/B,YAAM,WAAW,IAAI;AAGrB,UAAI,aAAa,oBAAoB;AACnC,eAAO,MAAM,qBAAqB,SAAS,GAAG;AAAA,MAChD;AAGA,UAAI,aAAa,iBAAiB;AAChC,eAAO,MAAM,kBAAkB,SAAS,GAAG;AAAA,MAC7C;AAIA,YAAM,YAAY,IAAI,aAAa,IAAI,KAAK;AAG5C,UAAI,CAAC,WAAW;AACd,eAAO,oBAAoB,2BAA2B,KAAK,OAAO;AAAA,MACpE;AAGA,UAAI,CAAC,oBAAoB,KAAK,SAAS,GAAG;AACxC,eAAO;AAAA,UACL;AAAA,UACA;AAAA,UACA;AAAA,QACF;AAAA,MACF;AAGA,YAAM,WAAW,MAAM,iBAAiB,WAAW,oBAAoB,MAAM,iBAAiB;AAG9F,UAAI,CAAC,SAAS,IAAI;AAChB,eAAO;AAAA,UACL,6BAA6B,SAAS,MAAM,IAAI,SAAS,UAAU;AAAA,UACnE,SAAS;AAAA,UACT;AAAA,QACF;AAAA,MACF;AAGA,YAAM,UAAU,MAAM,SAAS,KAAK;AAGpC,UAAI,CAAC,QAAQ,SAAS,OAAO,KAAK,CAAC,QAAQ,SAAS,OAAO,GAAG;AAC5D,eAAO,oBAAoB,qCAAqC,KAAK,OAAO;AAAA,MAC9E;AAGA,YAAM,gBAAgB,iBAAiB,OAAO;AAC9C,aAAO,IAAI,SAAS,SAAS;AAAA,QAC3B,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,+BAA+B,iBAAiB;AAAA,UAChD,gCAAgC;AAAA,UAChC,gCAAgC;AAAA,UAChC,QAAQ;AAAA,UACR,0BAA0B;AAAA,UAC1B,iBAAiB,mBAAmB,iBAAiB;AAAA;AAAA,UACrD,cAAc;AAAA,QAChB;AAAA,MACF,CAAC;AAAA,IAEH,SAAS,OAAO;AACd,cAAQ,MAAM,iBAAiB,KAAK;AACpC,aAAO;AAAA,QACL,gBAAgB,SAAS,MAAM,UAAU,MAAM,UAAU,OAAO,KAAK,CAAC;AAAA,QACtE;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF;AAqBA,eAAe,kBAAkB,SAAS,KAAK;AAC7C,QAAM,gBAAgB,iBAAiB,OAAO;AAC9C,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAG/B,QAAM,YAAY,IAAI,aAAa,IAAI,WAAW,KAAK;AACvD,QAAM,WAAW,IAAI,aAAa,IAAI,OAAO;AAC7C,QAAM,eAAe,IAAI,aAAa,IAAI,WAAW,KAAK;AAC1D,QAAM,aAAa,IAAI,aAAa,IAAI,SAAS,KAAK;AACtD,QAAM,mBAAmB,IAAI,aAAa,IAAI,WAAW,KAAK;AAG9D,MAAI,CAAC,0BAA0B,KAAK,SAAS,GAAG;AAC9C,WAAO;AAAA,MACL;AAAA,QACE,MAAM,YAAY;AAAA,QAClB,SAAS;AAAA,MACX;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAEA,QAAM,QAAQ,MAAM,OAAO,SAAS,YAAY,MAAM,EAAE,GAAG,GAAG,gBAAgB;AAG9E,MAAI,YAAY;AAChB,MAAI,UAAU;AACd,MAAI,cAAc;AAChB,gBAAY,kBAAkB,YAAY;AAC1C,QAAI,CAAC,WAAW;AACd,aAAO;AAAA,QACL,EAAE,MAAM,YAAY,aAAa,SAAS,yFAAkC;AAAA,QAC5E;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACA,MAAI,YAAY;AACd,cAAU,gBAAgB,UAAU;AACpC,QAAI,CAAC,SAAS;AACZ,aAAO;AAAA,QACL,EAAE,MAAM,YAAY,aAAa,SAAS,uFAAgC;AAAA,QAC1E;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACA,MAAI,aAAa,WAAW,YAAY,SAAS;AAC/C,WAAO;AAAA,MACL,EAAE,MAAM,YAAY,aAAa,SAAS,0GAAoC;AAAA,MAC9E;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAGA,QAAM,cAAc,IAAI,IAAI,kDAAkD;AAC9E,cAAY,aAAa,IAAI,aAAa,SAAS;AACnD,cAAY,aAAa,IAAI,SAAS,OAAO,KAAK,CAAC;AACnD,MAAI,aAAc,aAAY,aAAa,IAAI,aAAa,YAAY;AACxE,MAAI,WAAY,aAAY,aAAa,IAAI,WAAW,UAAU;AAClE,MAAI,iBAAkB,aAAY,aAAa,IAAI,aAAa,gBAAgB;AAChF,QAAM,QAAQ,OAAO;AACrB,QAAM,eAAe,IAAI,QAAQ,YAAY,SAAS,GAAG,EAAE,QAAQ,MAAM,CAAC;AAG1E,QAAM,SAAS,MAAM,MAAM,MAAM,YAAY;AAC7C,MAAI,QAAQ;AAEV,UAAM,OAAO,MAAM,OAAO,YAAY;AACtC,UAAMA,WAAU,IAAI,QAAQ,OAAO,OAAO;AAC1C,IAAAA,SAAQ,IAAI,+BAA+B,iBAAiB,GAAG;AAC/D,IAAAA,SAAQ,IAAI,gCAAgC,cAAc;AAC1D,IAAAA,SAAQ,IAAI,gCAAgC,cAAc;AAC1D,IAAAA,SAAQ,IAAI,QAAQ,QAAQ;AAC5B,IAAAA,SAAQ,IAAI,WAAW,KAAK;AAC5B,WAAO,IAAI,SAAS,MAAM,EAAE,QAAQ,OAAO,QAAQ,SAAAA,SAAQ,CAAC;AAAA,EAC9D;AAGA,QAAM,SAAS,iBAAiB,GAAG;AACnC,MAAI,CAAC,QAAQ;AACX,WAAO;AAAA,MACL,EAAE,MAAM,YAAY,aAAa,SAAS,6FAA4B;AAAA,MACtE;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAGA,QAAM,YAAY,gBAAgB,aAAa,OAAO,CAAC;AACvD,QAAM,YAAY,MAAM,eAAe,KAAK,WAAW,IAAI,GAAM;AACjE,MAAI,UAAU,SAAS;AACrB,WAAO;AAAA,MACL;AAAA,QACE,MAAM,YAAY;AAAA,QAClB,SAAS;AAAA,QACT,eAAe,UAAU;AAAA,MAC3B;AAAA,MACA;AAAA,MACA;AAAA,MACA,UAAU;AAAA,IACZ;AAAA,EACF;AAGA,QAAM,oBAAoB,OAAO,UAAU,MAAM,CAAC;AAGlD,MAAI,YAAY;AAChB,MAAI,YAAY;AAChB,MAAI,eAAe;AACnB,MAAI,SAAS,CAAC;AACd,MAAI,mBAAmB;AACvB,MAAI,UAAU;AACd,MAAI,kBAAkB;AAGtB,SAAO,YAAY,aAAa,OAAO,SAAS,OAAO;AACrD;AAGA,UAAM,WAAW;AACjB,UAAM,SAAS,IAAI,gBAAgB;AACnC,WAAO,IAAI,QAAQ,SAAS;AAC5B,WAAO,IAAI,cAAc,iBAAiB;AAC1C,WAAO,IAAI,cAAc,OAAO,gBAAgB,CAAC;AACjD,QAAI,UAAW,QAAO,IAAI,aAAa,SAAS;AAChD,WAAO,IAAI,UAAU,oEAAoE;AACzF,WAAO,IAAI,eAAe,OAAO;AACjC,WAAO,IAAI,OAAO,MAAM;AAExB,UAAM,SAAS,MAAM;AAAA,MACnB;AAAA,MACA;AAAA,MACA;AAAA,QACE,WAAW;AAAA,QACX,YAAY;AAAA,QACZ;AAAA,QACA;AAAA,MACF;AAAA,IACF;AAEA,QAAI,OAAO,OAAO;AAEhB,aAAO,UAAU,OAAO,OAAO,OAAO,UAAU,KAAK,eAAe,OAAO,aAAa;AAAA,IAC1F;AAEA,UAAM,OAAO,OAAO,QAAQ,CAAC;AAC7B,UAAM,QAAQ,MAAM,QAAQ,KAAK,KAAK,IAAI,KAAK,QAAQ,CAAC;AACxD,oBAAgB,MAAM;AAGtB,QAAI,CAAC,MAAM,UAAU,CAAC,KAAK,eAAe;AACxC,yBAAmB;AACnB,gBAAU;AACV;AAAA,IACF;AAGA,UAAM,aAAa,CAAC;AACpB,QAAI,iBAAiB;AAErB,eAAW,MAAM,OAAO;AACtB,YAAM,KAAK,MAAM,GAAG,UAAU,GAAG,UAAU;AAC3C,UAAI,CAAC,GAAI;AAET,YAAM,SAAS,GAAG,SAAS,IAAI,KAAK;AAEpC,UAAI,CAAC,GAAG,cAAc,CAAC,GAAG,WAAW,QAAS;AAC9C,UAAI,UAAU,mBAAmB,UAAU,gBAAiB;AAE5D,YAAM,YAAY,IAAI,KAAK,GAAG,WAAW;AACzC,UAAI,MAAM,UAAU,QAAQ,CAAC,EAAG;AAGhC,UAAI,CAAC,kBAAkB,YAAY,gBAAgB;AACjD,yBAAiB;AAAA,MACnB;AAGA,UAAI,aAAa,YAAY,UAAW;AACxC,UAAI,WAAW,YAAY,QAAS;AAEpC,iBAAW,KAAK;AAAA,QACd,KAAK,mCAAmC,GAAG,WAAW,OAAO;AAAA,QAC7D;AAAA,QACA,WAAW,UAAU,YAAY;AAAA,MACnC,CAAC;AAAA,IACH;AAGA,eAAW,KAAK,YAAY;AAC1B,UAAI,OAAO,SAAS,MAAO,QAAO,KAAK,CAAC;AAAA,IAC1C;AAGA,QAAI,aAAa,kBAAkB,iBAAiB,WAAW;AAC7D,wBAAkB;AAAA,IACpB;AAGA,QAAI,OAAO,UAAU,OAAO;AAE1B,yBAAmB,KAAK,iBAAiB;AACzC,gBAAU,QAAQ,gBAAgB;AAClC;AAAA,IACF,WAAW,KAAK,iBAAiB,CAAC,iBAAiB;AAEjD,kBAAY,KAAK;AACjB,yBAAmB;AACnB,gBAAU;AACV;AAAA,IACF,OAAO;AAEL,yBAAmB;AACnB,gBAAU;AACV;AAAA,IACF;AAAA,EACF;AAGA,MAAI,eAAe;AACnB,MAAI;AACF,UAAM,gBAAgB,IAAI,gBAAgB;AAC1C,kBAAc,IAAI,QAAQ,SAAS;AACnC,kBAAc,IAAI,MAAM,SAAS;AACjC,kBAAc,IAAI,UAAU,sBAAsB;AAClD,kBAAc,IAAI,OAAO,MAAM;AAE/B,UAAM,aAAa,MAAM,oBAAoB,aAAa,eAAe;AAAA,MACvE,WAAW;AAAA,MACX,YAAY;AAAA,MACZ;AAAA,MACA;AAAA,IACF,CAAC;AAED,QAAI,WAAW,QAAQ,WAAW,KAAK,SAAS,WAAW,KAAK,MAAM,CAAC,GAAG;AACxE,qBAAe,WAAW,KAAK,MAAM,CAAC,EAAE,SAAS,SAAS;AAAA,IAC5D;AAAA,EACF,SAAS,GAAG;AAEV,YAAQ,KAAK,kCAAkC,CAAC;AAAA,EAClD;AAGA,QAAM,UAAU;AAAA,IACd,IAAI;AAAA,IACJ;AAAA,IACA;AAAA,IACA,OAAO,OAAO;AAAA,IACd,cAAc;AAAA,IACd;AAAA,IACA,eAAe,UAAU,mBAAmB;AAAA,IAC5C;AAAA,EACF;AAGA,QAAM,WAAW,KAAK,UAAU,OAAO;AACvC,QAAM,UAAU;AAAA,IACd,gBAAgB;AAAA,IAChB,+BAA+B,iBAAiB;AAAA,IAChD,gCAAgC;AAAA,IAChC,gCAAgC;AAAA,IAChC,QAAQ;AAAA,IACR,iBAAiB,mBAAmB,iBAAiB;AAAA,IACrD,WAAW;AAAA,EACb;AACA,QAAM,WAAW,IAAI,SAAS,UAAU,EAAE,QAAQ,KAAK,QAAQ,CAAC;AAEhE,MAAI;AACF,UAAM,MAAM;AAAA,MACV;AAAA,MACA,IAAI,SAAS,UAAU;AAAA,QACrB,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,mBAAmB,iBAAiB;AAAA,QACvD;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,SAAS,GAAG;AAEV,YAAQ,KAAK,uCAAuC,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC;AAAA,EACpF;AAEA,SAAO;AACT;AAhSe;AA8Sf,eAAe,qBAAqB,SAAS,KAAK;AAChD,QAAM,gBAAgB,iBAAiB,OAAO;AAC9C,QAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAE/B,QAAM,MACJ,IAAI,aAAa,IAAI,QAAQ,KAC7B,IAAI,aAAa,IAAI,GAAG,KACxB,IAAI,aAAa,IAAI,KAAK,KAC1B,IAAI,aAAa,IAAI,IAAI,KACzB;AAEF,MAAI,CAAC,KAAK;AACR,WAAO;AAAA,MACL,EAAE,MAAM,YAAY,aAAa,SAAS,uIAAmC;AAAA,MAC7E;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAGA,QAAM,cAAc,iBAAiB,GAAG;AACxC,MAAI,aAAa;AACf,WAAO;AAAA,MACL;AAAA,QACE,IAAI;AAAA,QACJ,OAAO;AAAA,QACP,WAAW;AAAA,MACb;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAGA,QAAM,SAAS,cAAc,GAAG;AAChC,MAAI,CAAC,QAAQ;AACX,WAAO;AAAA,MACL,EAAE,MAAM,YAAY,aAAa,SAAS,wHAAyB;AAAA,MACnE;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAGA,QAAM,cAAc,IAAI,IAAI,qDAAqD;AACjF,cAAY,aAAa,IAAI,UAAU,MAAM;AAC7C,QAAM,QAAQ,OAAO;AACrB,QAAM,eAAe,IAAI,QAAQ,YAAY,SAAS,GAAG,EAAE,QAAQ,MAAM,CAAC;AAE1E,QAAM,SAAS,MAAM,MAAM,MAAM,YAAY;AAC7C,MAAI,QAAQ;AACV,UAAM,OAAO,MAAM,OAAO,YAAY;AACtC,UAAM,UAAU,IAAI,QAAQ,OAAO,OAAO;AAC1C,YAAQ,IAAI,+BAA+B,iBAAiB,GAAG;AAC/D,YAAQ,IAAI,gCAAgC,cAAc;AAC1D,YAAQ,IAAI,gCAAgC,cAAc;AAC1D,YAAQ,IAAI,QAAQ,QAAQ;AAC5B,YAAQ,IAAI,WAAW,KAAK;AAC5B,WAAO,IAAI,SAAS,MAAM,EAAE,QAAQ,OAAO,QAAQ,QAAQ,CAAC;AAAA,EAC9D;AAGA,QAAM,SAAS,iBAAiB,GAAG;AACnC,MAAI,CAAC,QAAQ;AACX,WAAO;AAAA,MACL,EAAE,MAAM,YAAY,aAAa,SAAS,6FAA4B;AAAA,MACtE;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAGA,QAAM,YAAY,mBAAmB,aAAa,OAAO,CAAC;AAC1D,QAAM,YAAY,MAAM,eAAe,KAAK,WAAW,KAAK,GAAM;AAClE,MAAI,UAAU,SAAS;AACrB,WAAO;AAAA,MACL;AAAA,QACE,MAAM,YAAY;AAAA,QAClB,SAAS;AAAA,QACT,eAAe,UAAU;AAAA,MAC3B;AAAA,MACA;AAAA,MACA;AAAA,MACA,UAAU;AAAA,IACZ;AAAA,EACF;AAGA,QAAM,WAAW;AACjB,QAAM,SAAS,IAAI,gBAAgB;AACnC,SAAO,IAAI,QAAQ,IAAI;AACvB,SAAO,IAAI,aAAa,OAAO,WAAW,GAAG,IAAI,SAAS,IAAI,MAAM,EAAE;AACtE,SAAO,IAAI,UAAU,WAAW;AAChC,SAAO,IAAI,eAAe,OAAO;AACjC,SAAO,IAAI,OAAO,MAAM;AAExB,QAAM,SAAS,MAAM;AAAA,IACnB;AAAA,IACA;AAAA,IACA;AAAA,MACE,WAAW;AAAA,MACX,YAAY;AAAA,MACZ;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAEA,MAAI,OAAO,OAAO;AAChB,WAAO,UAAU,OAAO,OAAO,OAAO,UAAU,KAAK,eAAe,OAAO,aAAa;AAAA,EAC1F;AAEA,QAAM,OAAO,OAAO,QAAQ,CAAC;AAC7B,QAAM,QAAQ,MAAM,QAAQ,KAAK,KAAK,IAAI,KAAK,QAAQ,CAAC;AACxD,MAAI,CAAC,MAAM,UAAU,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,IAAI;AAC9C,WAAO,UAAU,EAAE,MAAM,YAAY,WAAW,SAAS,yGAAoB,GAAG,KAAK,aAAa;AAAA,EACpG;AACA,QAAM,YAAY,MAAM,CAAC,EAAE;AAE3B,QAAM,cAAc;AAAA,IAClB,IAAI;AAAA,IACJ,OAAO;AAAA,IACP;AAAA,EACF;AACA,QAAM,WAAW,KAAK,UAAU,WAAW;AAC3C,QAAM,WAAW,IAAI,SAAS,UAAU;AAAA,IACtC,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,gBAAgB;AAAA,MAChB,+BAA+B,iBAAiB;AAAA,MAChD,gCAAgC;AAAA,MAChC,gCAAgC;AAAA,MAChC,QAAQ;AAAA,MACR,iBAAiB,mBAAmB,iBAAiB;AAAA,MACrD,WAAW;AAAA,IACb;AAAA,EACF,CAAC;AAED,MAAI;AACF,UAAM,MAAM;AAAA,MACV;AAAA,MACA,IAAI,SAAS,UAAU;AAAA,QACrB,QAAQ;AAAA,QACR,SAAS;AAAA,UACP,gBAAgB;AAAA,UAChB,iBAAiB,mBAAmB,iBAAiB;AAAA,QACvD;AAAA,MACF,CAAC;AAAA,IACH;AAAA,EACF,SAAS,GAAG;AACV,YAAQ,KAAK,0CAA0C,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC;AAAA,EACvF;AAEA,SAAO;AACT;AAxJe;AA6Jf,SAAS,WAAW,SAAS;AAC3B,QAAM,gBAAgB,iBAAiB,OAAO;AAC9C,SAAO,IAAI,SAAS,MAAM;AAAA,IACxB,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,+BAA+B,iBAAiB;AAAA,MAChD,gCAAgC;AAAA,MAChC,gCAAgC;AAAA,MAChC,0BAA0B;AAAA,MAC1B,QAAQ;AAAA,IACV;AAAA,EACF,CAAC;AACH;AAZS;AAiBT,SAAS,gBAAgB,QAAQ;AAC/B,MAAI,CAAC,OAAQ,QAAO;AACpB,MAAI,gBAAgB,SAAS,MAAM,EAAG,QAAO;AAC7C,MAAI,qBAAqB,KAAK,MAAM,EAAG,QAAO;AAC9C,SAAO;AACT;AALS;AAUT,SAAS,iBAAiB,SAAS;AACjC,QAAM,SAAS,QAAQ,QAAQ,IAAI,QAAQ;AAC3C,MAAI,UAAU,gBAAgB,MAAM,EAAG,QAAO;AAC9C,SAAO;AACT;AAJS;AAST,SAAS,oBAAoB,SAAS,SAAS,KAAK,SAAS;AAC3D,QAAM,gBAAgB,iBAAiB,OAAO;AAC9C,SAAO,IAAI,SAAS,SAAS;AAAA,IAC3B;AAAA,IACA,SAAS;AAAA,MACP,gBAAgB;AAAA,MAChB,+BAA+B,iBAAiB;AAAA,MAChD,gCAAgC;AAAA,MAChC,gCAAgC;AAAA,MAChC,QAAQ;AAAA,MACR,0BAA0B;AAAA,IAC5B;AAAA,EACF,CAAC;AACH;AAbS;AAkBT,SAAS,UAAU,UAAU,SAAS,KAAK,gBAAgB,IAAI,eAAe;AAC5E,QAAM,OAAO,KAAK,UAAU,EAAE,IAAI,OAAO,GAAG,SAAS,CAAC;AACtD,QAAM,UAAU;AAAA,IACd,gBAAgB;AAAA,IAChB,+BAA+B,iBAAiB;AAAA,IAChD,gCAAgC;AAAA,IAChC,gCAAgC;AAAA,IAChC,QAAQ;AAAA,IACR,iBAAiB;AAAA,EACnB;AACA,MAAI,iBAAiB,OAAO,SAAS,aAAa,GAAG;AACnD,YAAQ,aAAa,IAAI,OAAO,KAAK,IAAI,GAAG,KAAK,MAAM,aAAa,CAAC,CAAC;AAAA,EACxE;AACA,SAAO,IAAI,SAAS,MAAM,EAAE,QAAQ,QAAQ,CAAC;AAC/C;AAdS;AAmBT,SAAS,OAAO,SAAS,gBAAgB,IAAI;AAC3C,QAAM,OAAO,KAAK,UAAU,OAAO;AACnC,SAAO,IAAI,SAAS,MAAM;AAAA,IACxB,QAAQ;AAAA,IACR,SAAS;AAAA,MACP,gBAAgB;AAAA,MAChB,+BAA+B,iBAAiB;AAAA,MAChD,gCAAgC;AAAA,MAChC,gCAAgC;AAAA,MAChC,QAAQ;AAAA,MACR,iBAAiB,mBAAmB,iBAAiB;AAAA,IACvD;AAAA,EACF,CAAC;AACH;AAbS;AAqBT,eAAe,iBAAiB,OAAO,YAAY,oBAAoB,WAAW,OAAO,cAAc,mBAAmB,YAAY,CAAC,GAAG;AACxI,QAAM,aAAa,IAAI,gBAAgB;AACvC,QAAM,KAAK,WAAW,MAAM,WAAW,MAAM,SAAS,GAAG,SAAS;AAElE,MAAI;AACF,UAAM,MAAM,iBAAiB,UACzB,QACA,IAAI,QAAQ,OAAO,KAAK,GAAG;AAAA,MACzB,QAAQ;AAAA,MACR,SAAS;AAAA,QACP,cAAc;AAAA,MAChB;AAAA,MACA,GAAG;AAAA,MACH,QAAQ,WAAW;AAAA,IACrB,CAAC;AAEL,QAAI,CAAC,UAAU;AACb,YAAMC,OAAM,MAAM,MAAM,KAAK,EAAE,QAAQ,WAAW,OAAO,CAAC;AAC1D,aAAOA;AAAA,IACT;AAGA,UAAM,QAAQ,OAAO;AACrB,UAAM,WAAW,IAAI,QAAQ,IAAI,KAAK,EAAE,QAAQ,MAAM,CAAC;AACvD,UAAM,SAAS,MAAM,MAAM,MAAM,QAAQ;AACzC,QAAI,OAAQ,QAAO;AAEnB,UAAM,MAAM,MAAM,MAAM,KAAK,EAAE,QAAQ,WAAW,OAAO,CAAC;AAC1D,QAAI,IAAI,IAAI;AACV,YAAM,UAAU,IAAI,QAAQ,IAAI,OAAO;AACvC,cAAQ,IAAI,iBAAiB,mBAAmB,WAAW,EAAE;AAC7D,YAAM,YAAY,IAAI,SAAS,IAAI,MAAM;AAAA,QACvC,QAAQ,IAAI;AAAA,QACZ;AAAA,MACF,CAAC;AACD,UAAI;AACF,cAAM,MAAM,IAAI,UAAU,UAAU,MAAM,CAAC;AAAA,MAC7C,SAAS,GAAG;AACV,gBAAQ,KAAK,qBAAqB,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC;AAAA,MAClE;AACA,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT,SAAS,KAAK;AACZ,QAAI,OAAO,OAAO,GAAG,EAAE,SAAS,SAAS,GAAG;AAC1C,YAAM,MAAM,IAAI,SAAS,oBAAoB,EAAE,QAAQ,IAAI,CAAC;AAC5D,aAAO;AAAA,IACT;AACA,UAAM;AAAA,EACR,UAAE;AACA,iBAAa,EAAE;AAAA,EACjB;AACF;AApDe;AAgEf,eAAe,oBAAoB,UAAU,QAAQ,EAAE,WAAW,YAAY,SAAS,IAAI,GAAG;AAC5F,QAAM,MAAM,IAAI,IAAI,cAAc,QAAQ;AAC1C,aAAW,CAAC,GAAG,CAAC,KAAK,OAAO,QAAQ,EAAG,KAAI,aAAa,IAAI,GAAG,CAAC;AAEhE,MAAI,UAAU;AACd,MAAI,SAAS;AAEb,SAAO,WAAW,YAAY;AAC5B;AAEA,QAAI;AACF,YAAM,MAAM,MAAM;AAAA,QAChB,IAAI,QAAQ,IAAI,SAAS,GAAG;AAAA,UAC1B,SAAS;AAAA,YACP,cAAc;AAAA,UAChB;AAAA,QACF,CAAC;AAAA,QACD;AAAA,QACA;AAAA,MACF;AAGA,UAAI,IAAI,WAAW,KAAK;AACtB,YAAI,WAAW,YAAY;AACzB,gBAAM,MAAM,MAAM;AAClB,oBAAU;AACV;AAAA,QACF;AACA,eAAO;AAAA,UACL,OAAO,EAAE,MAAM,YAAY,SAAS,SAAS,yGAA8B;AAAA,UAC3E,QAAQ;AAAA,QACV;AAAA,MACF;AAGA,UAAI,IAAI,IAAI;AACV,YAAI,OAAO;AACX,YAAI;AACF,iBAAO,MAAM,IAAI,KAAK;AAAA,QACxB,QAAQ;AACN,iBAAO,CAAC;AAAA,QACV;AACA,eAAO,EAAE,MAAM,QAAQ,IAAI,OAAO;AAAA,MACpC;AAGA,YAAM,OAAO,MAAM,IAAI,KAAK;AAC5B,YAAM,UAAU,qBAAqB,IAAI,KAAK,CAAC;AAC/C,YAAM,SAAS,QAAQ,UAAU;AACjC,YAAM,UAAU,QAAQ,WAAW,sBAAsB,IAAI,MAAM;AAGnE,UAAI,IAAI,WAAW,KAAK;AACtB,cAAM,gBAAgB,gBAAgB,IAAI,QAAQ,IAAI,aAAa,CAAC,KAAK,KAAK,KAAK,SAAS,GAAI;AAChG,YAAI,WAAW,YAAY;AACzB,gBAAM,MAAM,gBAAgB,GAAI;AAChC;AAAA,QACF;AACA,eAAO;AAAA,UACL,OAAO,EAAE,MAAM,YAAY,cAAc,SAAS,8FAA6B,cAAc;AAAA,UAC7F,QAAQ;AAAA,UACR;AAAA,QACF;AAAA,MACF;AAEA,UAAI,IAAI,UAAU,OAAO,IAAI,SAAS,KAAK;AACzC,YAAI,WAAW,YAAY;AACzB,gBAAM,MAAM,MAAM;AAClB,oBAAU;AACV;AAAA,QACF;AACA,eAAO;AAAA,UACL,OAAO,EAAE,MAAM,YAAY,aAAa,SAAS,+GAA+B;AAAA,UAChF,QAAQ,IAAI;AAAA,QACd;AAAA,MACF;AAEA,UAAI,IAAI,WAAW,KAAK;AACtB,YAAI,WAAW,mBAAmB,WAAW,sBAAsB;AACjE,iBAAO;AAAA,YACL,OAAO,EAAE,MAAM,YAAY,gBAAgB,SAAS,6FAA4B;AAAA,YAChF,QAAQ;AAAA,UACV;AAAA,QACF;AACA,YAAI,WAAW,uBAAuB,WAAW,yBAAyB;AAExE,cAAI,WAAW,YAAY;AACzB,kBAAM,MAAM,MAAM;AAClB,sBAAU;AACV;AAAA,UACF;AACA,iBAAO;AAAA,YACL,OAAO,EAAE,MAAM,YAAY,cAAc,SAAS,6FAA4B;AAAA,YAC9E,QAAQ;AAAA,UACV;AAAA,QACF;AACA,eAAO;AAAA,UACL,OAAO,EAAE,MAAM,YAAY,aAAa,SAAS,WAAW,iFAAgB;AAAA,UAC5E,QAAQ;AAAA,QACV;AAAA,MACF;AAEA,UAAI,IAAI,WAAW,KAAK;AACtB,eAAO,EAAE,OAAO,EAAE,MAAM,YAAY,aAAa,SAAS,+DAAuB,GAAG,QAAQ,IAAI;AAAA,MAClG;AAEA,UAAI,IAAI,WAAW,KAAK;AACtB,eAAO,EAAE,OAAO,EAAE,MAAM,YAAY,WAAW,SAAS,uFAAiB,GAAG,QAAQ,IAAI;AAAA,MAC1F;AAEA,UAAI,IAAI,WAAW,KAAK;AAEtB,eAAO;AAAA,UACL,OAAO;AAAA,YACL,MAAM,YAAY;AAAA,YAClB,SAAS,WAAW;AAAA,UACtB;AAAA,UACA,QAAQ;AAAA,QACV;AAAA,MACF;AAGA,aAAO,EAAE,OAAO,EAAE,MAAM,YAAY,aAAa,QAAiB,GAAG,QAAQ,IAAI,OAAO;AAAA,IAC1F,SAAS,GAAG;AAEV,UAAI,WAAW,YAAY;AACzB,cAAM,MAAM,MAAM;AAClB,kBAAU;AACV;AAAA,MACF;AACA,aAAO;AAAA,QACL,OAAO,EAAE,MAAM,YAAY,aAAa,SAAS,6FAA4B;AAAA,QAC7E,QAAQ;AAAA,MACV;AAAA,IACF;AAAA,EACF;AAEA,SAAO;AAAA,IACL,OAAO,EAAE,MAAM,YAAY,aAAa,SAAS,6FAA4B;AAAA,IAC7E,QAAQ;AAAA,EACV;AACF;AA7Ie;AAqJf,eAAe,eAAe,KAAK,KAAK,OAAO,UAAU;AACvD,MAAI;AACF,QAAI,CAAC,OAAO,CAAC,IAAI,cAAc;AAE7B,aAAO,EAAE,SAAS,OAAO,WAAW,OAAO,kBAAkB,eAAe,EAAE;AAAA,IAChF;AACA,UAAM,KAAK,IAAI,aAAa,WAAW,GAAG;AAC1C,UAAM,OAAO,IAAI,aAAa,IAAI,EAAE;AACpC,UAAM,OAAO,MAAM,KAAK,MAAM,qBAAqB,mBAAmB,GAAG,CAAC,UAAU,KAAK,aAAa,QAAQ,EAAE;AAChH,UAAM,OAAO,MAAM,KAAK,KAAK;AAC7B,WAAO;AAAA,MACL,SAAS,CAAC,CAAC,KAAK;AAAA,MAChB,WAAW,OAAO,KAAK,cAAc,WAAW,KAAK,YAAY;AAAA,MACjE,eAAe,OAAO,KAAK,kBAAkB,WAAW,KAAK,gBAAgB;AAAA,IAC/E;AAAA,EACF,SAAS,GAAG;AAEV,YAAQ,KAAK,6BAA6B,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC;AACxE,WAAO,EAAE,SAAS,OAAO,WAAW,OAAO,kBAAkB,eAAe,EAAE;AAAA,EAChF;AACF;AApBe;AA0Bf,SAAS,qBAAqB,MAAM;AAClC,MAAI;AACF,UAAM,MAAM,KAAK,MAAM,IAAI;AAC3B,QAAI,OAAO,IAAI,OAAO;AAEpB,YAAM,IAAI,IAAI;AACd,UAAI,MAAM,QAAQ,EAAE,MAAM,KAAK,EAAE,OAAO,CAAC,GAAG;AAC1C,eAAO,EAAE,SAAS,EAAE,WAAW,IAAI,QAAQ,EAAE,OAAO,CAAC,EAAE,UAAU,GAAG;AAAA,MACtE;AACA,UAAI,EAAE,UAAU,EAAE,SAAS;AAGzB,cAAM,SACH,MAAM,QAAQ,EAAE,OAAO,KACtB,EAAE,QAAQ,KAAK,CAAC,MAAM,MAAM,QAAQ,EAAE,MAAM,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE,MAAM,GAAG,SAAS,CAAC,GAAG,UACpG;AACF,eAAO,EAAE,SAAS,EAAE,SAAS,OAAO;AAAA,MACtC;AACA,aAAO,EAAE,SAAS,EAAE,WAAW,qBAAqB,QAAQ,GAAG;AAAA,IACjE;AAAA,EACF,QAAQ;AAAA,EAER;AACA,SAAO;AACT;AAxBS;AA6BT,SAAS,gBAAgB,GAAG;AAC1B,MAAI,CAAC,EAAG,QAAO;AACf,QAAM,MAAM,OAAO,SAAS,GAAG,EAAE;AACjC,MAAI,OAAO,SAAS,GAAG,EAAG,QAAO,KAAK,IAAI,GAAG,GAAG;AAChD,QAAM,OAAO,IAAI,KAAK,CAAC;AACvB,MAAI,CAAC,MAAM,KAAK,QAAQ,CAAC,GAAG;AAC1B,UAAM,MAAM,KAAK,IAAI;AACrB,WAAO,KAAK,IAAI,GAAG,KAAK,MAAM,KAAK,QAAQ,IAAI,OAAO,GAAI,CAAC;AAAA,EAC7D;AACA,SAAO;AACT;AAVS;AAeT,SAAS,MAAM,IAAI;AACjB,SAAO,IAAI,QAAQ,CAAC,MAAM,WAAW,GAAG,EAAE,CAAC;AAC7C;AAFS;AAOT,SAAS,MAAM,GAAG,KAAK,KAAK;AAC1B,MAAI,CAAC,OAAO,SAAS,CAAC,EAAG,QAAO;AAChC,SAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,GAAG,GAAG;AACvC;AAHS;AAQT,SAAS,kBAAkB,GAAG;AAC5B,MAAI,CAAC,sBAAsB,KAAK,CAAC,EAAG,QAAO;AAC3C,QAAM,IAAI,oBAAI,KAAK,GAAG,CAAC,gBAAgB;AACvC,MAAI,MAAM,EAAE,QAAQ,CAAC,EAAG,QAAO;AAC/B,SAAO;AACT;AALS;AAUT,SAAS,gBAAgB,GAAG;AAC1B,MAAI,CAAC,sBAAsB,KAAK,CAAC,EAAG,QAAO;AAC3C,QAAM,IAAI,oBAAI,KAAK,GAAG,CAAC,gBAAgB;AACvC,MAAI,MAAM,EAAE,QAAQ,CAAC,EAAG,QAAO;AAC/B,SAAO;AACT;AALS;AAUT,SAAS,cAAc,KAAK;AAC1B,QAAM,IAAI,OAAO,GAAG,EAAE,KAAK;AAE3B,MAAI;AACF,UAAM,IAAI,IAAI,IAAI,CAAC;AAEnB,UAAM,IAAI,EAAE,SAAS,MAAM,aAAa;AACxC,QAAI,KAAK,EAAE,CAAC,GAAG;AACb,aAAO,EAAE,CAAC,EAAE,WAAW,IAAI,IAAI,IAAI,EAAE,CAAC,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;AAAA,IACtD;AAAA,EACF,QAAQ;AAAA,EAER;AAEA,MAAI,EAAE,WAAW,GAAG,EAAG,QAAO;AAC9B,MAAI,oBAAoB,KAAK,CAAC,EAAG,QAAO,IAAI,CAAC;AAC7C,SAAO;AACT;AAjBS;AAsBT,SAAS,iBAAiB,KAAK;AAC7B,QAAM,IAAI,OAAO,GAAG,EAAE,KAAK;AAE3B,MAAI,0BAA0B,KAAK,CAAC,EAAG,QAAO;AAE9C,MAAI;AACF,UAAM,IAAI,IAAI,IAAI,CAAC;AACnB,UAAM,MAAM,EAAE,aAAa,IAAI,SAAS,KAAK,EAAE,aAAa,IAAI,YAAY;AAC5E,QAAI,OAAO,0BAA0B,KAAK,GAAG,EAAG,QAAO;AAEvD,UAAM,IAAI,EAAE,SAAS,MAAM,kCAAkC;AAC7D,QAAI,KAAK,EAAE,CAAC,EAAG,QAAO,EAAE,CAAC;AAAA,EAC3B,QAAQ;AAAA,EAER;AACA,SAAO;AACT;AAhBS;AAqBT,SAAS,aAAa,SAAS;AAC7B,QAAM,KAAK,QAAQ,QAAQ,IAAI,kBAAkB,KACtC,QAAQ,QAAQ,IAAI,iBAAiB,KACrC;AACX,QAAM,SAAS,QAAQ,QAAQ,IAAI,QAAQ,KAAK;AAChD,SAAO,GAAG,EAAE,IAAI,MAAM;AACxB;AANS;AAWT,SAAS,iBAAiB,KAAK;AAC7B,SAAO,QAAQ,IAAI,cAAc,IAAI,mBAAmB,IAAI;AAC9D;AAFS;AAcF,IAAM,cAAN,MAAkB;AAAA,EA7lCzB,OA6lCyB;AAAA;AAAA;AAAA,EACvB,YAAY,OAAO,KAAK;AACtB,SAAK,QAAQ;AACb,SAAK,MAAM;AAAA,EACb;AAAA,EAEA,MAAM,MAAM,SAAS;AACnB,QAAI;AACF,YAAM,MAAM,IAAI,IAAI,QAAQ,GAAG;AAE/B,YAAM,MAAM,IAAI,aAAa,IAAI,KAAK,KAAK;AAC3C,YAAM,QAAQ,MAAM,OAAO,SAAS,IAAI,aAAa,IAAI,OAAO,KAAK,MAAM,EAAE,GAAG,GAAG,GAAM;AACzF,YAAM,WAAW,MAAM,OAAO,SAAS,IAAI,aAAa,IAAI,UAAU,KAAK,SAAS,EAAE,GAAG,KAAK,KAAU;AAExG,YAAM,MAAM,KAAK,IAAI;AACrB,YAAM,aAAa,MAAM,GAAG;AAC5B,UAAI,OAAO,MAAM,KAAK,MAAM,QAAQ,IAAI,UAAU;AAElD,UAAI,CAAC,QAAQ,OAAO,SAAS,UAAU;AACrC,eAAO,EAAE,aAAa,KAAK,OAAO,EAAE;AAAA,MACtC;AAEA,UAAI,EAAE,aAAa,MAAM,IAAI;AAG7B,UAAI,MAAM,eAAe,UAAU;AACjC,sBAAc;AACd,gBAAQ;AAAA,MACV;AAGA,eAAS;AAGT,YAAM,KAAK,MAAM,QAAQ,IAAI,YAAY,EAAE,aAAa,MAAM,CAAC;AAG/D,UAAI,UAAU;AACd,UAAI,gBAAgB;AACpB,UAAI,QAAQ,OAAO;AACjB,kBAAU;AACV,cAAM,YAAY,YAAY,MAAM;AACpC,wBAAgB,KAAK,IAAI,GAAG,KAAK,KAAK,YAAY,GAAI,CAAC;AAAA,MACzD;AAEA,YAAM,YAAY,KAAK,IAAI,GAAG,QAAQ,KAAK;AAE3C,aAAO,IAAI;AAAA,QACT,KAAK,UAAU,EAAE,SAAS,WAAW,cAAc,CAAC;AAAA,QACpD;AAAA,UACE,QAAQ;AAAA,UACR,SAAS;AAAA,YACP,gBAAgB;AAAA,YAChB,iBAAiB;AAAA,UACnB;AAAA,QACF;AAAA,MACF;AAAA,IACF,SAAS,GAAG;AACV,aAAO,IAAI;AAAA,QACT,KAAK,UAAU;AAAA,UACb,SAAS;AAAA,UACT,WAAW;AAAA,UACX,eAAe;AAAA,UACf,OAAO,OAAO,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC;AAAA,QAC9C,CAAC;AAAA,QACD,EAAE,QAAQ,KAAK,SAAS,EAAE,gBAAgB,kCAAkC,EAAE;AAAA,MAChF;AAAA,IACF;AAAA,EACF;AACF;;;AChqCA,IAAM,YAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,UAAE;AACD,QAAI;AACH,UAAI,QAAQ,SAAS,QAAQ,CAAC,QAAQ,UAAU;AAC/C,cAAM,SAAS,QAAQ,KAAK,UAAU;AACtC,eAAO,EAAE,MAAM,OAAO,KAAK,GAAG,MAAM;AAAA,QAAC;AAAA,MACtC;AAAA,IACD,SAAS,GAAG;AACX,cAAQ,MAAM,4CAA4C,CAAC;AAAA,IAC5D;AAAA,EACD;AACD,GAb8B;AAe9B,IAAO,6CAAQ;;;ACRf,SAAS,YAAY,GAAmB;AACvC,SAAO;AAAA,IACN,MAAM,GAAG;AAAA,IACT,SAAS,GAAG,WAAW,OAAO,CAAC;AAAA,IAC/B,OAAO,GAAG;AAAA,IACV,OAAO,GAAG,UAAU,SAAY,SAAY,YAAY,EAAE,KAAK;AAAA,EAChE;AACD;AAPS;AAUT,IAAMC,aAAwB,8BAAO,SAAS,KAAK,MAAM,kBAAkB;AAC1E,MAAI;AACH,WAAO,MAAM,cAAc,KAAK,SAAS,GAAG;AAAA,EAC7C,SAAS,GAAQ;AAChB,UAAM,QAAQ,YAAY,CAAC;AAC3B,WAAO,SAAS,KAAK,OAAO;AAAA,MAC3B,QAAQ;AAAA,MACR,SAAS,EAAE,+BAA+B,OAAO;AAAA,IAClD,CAAC;AAAA,EACF;AACD,GAV8B;AAY9B,IAAO,2CAAQA;;;ACzBJ,IAAM,mCAAmC;AAAA,EAE9B;AAAA,EAAyB;AAC3C;AACA,IAAO,sCAAQ;;;ACcnB,IAAM,wBAAsC,CAAC;AAKtC,SAAS,uBAAuB,MAAqC;AAC3E,wBAAsB,KAAK,GAAG,KAAK,KAAK,CAAC;AAC1C;AAFgB;AAShB,SAAS,uBACR,SACA,KACA,KACA,UACA,iBACsB;AACtB,QAAM,CAAC,MAAM,GAAG,IAAI,IAAI;AACxB,QAAM,gBAAmC;AAAA,IACxC;AAAA,IACA,KAAK,YAAY,QAAQ;AACxB,aAAO,uBAAuB,YAAY,QAAQ,KAAK,UAAU,IAAI;AAAA,IACtE;AAAA,EACD;AACA,SAAO,KAAK,SAAS,KAAK,KAAK,aAAa;AAC7C;AAfS;AAiBF,SAAS,kBACf,SACA,KACA,KACA,UACA,iBACsB;AACtB,SAAO,uBAAuB,SAAS,KAAK,KAAK,UAAU;AAAA,IAC1D,GAAG;AAAA,IACH;AAAA,EACD,CAAC;AACF;AAXgB;;;AC3ChB,IAAM,iCAAN,MAAM,gCAA8D;AAAA,EAGnE,YACU,eACA,MACT,SACC;AAHQ;AACA;AAGT,SAAK,WAAW;AAAA,EACjB;AAAA,EArBD,OAYoE;AAAA;AAAA;AAAA,EAC1D;AAAA,EAUT,UAAU;AACT,QAAI,EAAE,gBAAgB,kCAAiC;AACtD,YAAM,IAAI,UAAU,oBAAoB;AAAA,IACzC;AAEA,SAAK,SAAS;AAAA,EACf;AACD;AAEA,SAAS,oBAAoB,QAA0C;AAEtE,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAEA,QAAM,kBAA+C,gCACpD,SACA,KACA,KACC;AACD,QAAI,OAAO,UAAU,QAAW;AAC/B,YAAM,IAAI,MAAM,6CAA6C;AAAA,IAC9D;AACA,WAAO,OAAO,MAAM,SAAS,KAAK,GAAG;AAAA,EACtC,GATqD;AAWrD,SAAO;AAAA,IACN,GAAG;AAAA,IACH,MAAM,SAAS,KAAK,KAAK;AACxB,YAAM,aAAyB,gCAAU,MAAM,MAAM;AACpD,YAAI,SAAS,eAAe,OAAO,cAAc,QAAW;AAC3D,gBAAM,aAAa,IAAI;AAAA,YACtB,KAAK,IAAI;AAAA,YACT,KAAK,QAAQ;AAAA,YACb,MAAM;AAAA,YAAC;AAAA,UACR;AACA,iBAAO,OAAO,UAAU,YAAY,KAAK,GAAG;AAAA,QAC7C;AAAA,MACD,GAT+B;AAU/B,aAAO,kBAAkB,SAAS,KAAK,KAAK,YAAY,eAAe;AAAA,IACxE;AAAA,EACD;AACD;AAxCS;AA0CT,SAAS,qBACR,OAC8B;AAE9B,MACC,qCAAqC,UACrC,iCAAiC,WAAW,GAC3C;AACD,WAAO;AAAA,EACR;AAEA,aAAW,cAAc,kCAAkC;AAC1D,wBAAoB,UAAU;AAAA,EAC/B;AAGA,SAAO,cAAc,MAAM;AAAA,IAC1B,mBAAyE,wBACxE,SACA,KACA,QACI;AACJ,WAAK,MAAM;AACX,WAAK,MAAM;AACX,UAAI,MAAM,UAAU,QAAW;AAC9B,cAAM,IAAI,MAAM,sDAAsD;AAAA,MACvE;AACA,aAAO,MAAM,MAAM,OAAO;AAAA,IAC3B,GAXyE;AAAA,IAazE,cAA0B,wBAAC,MAAM,SAAS;AACzC,UAAI,SAAS,eAAe,MAAM,cAAc,QAAW;AAC1D,cAAM,aAAa,IAAI;AAAA,UACtB,KAAK,IAAI;AAAA,UACT,KAAK,QAAQ;AAAA,UACb,MAAM;AAAA,UAAC;AAAA,QACR;AACA,eAAO,MAAM,UAAU,UAAU;AAAA,MAClC;AAAA,IACD,GAT0B;AAAA,IAW1B,MAAM,SAAwD;AAC7D,aAAO;AAAA,QACN;AAAA,QACA,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,MACN;AAAA,IACD;AAAA,EACD;AACD;AAnDS;AAqDT,IAAI;AACJ,IAAI,OAAO,wCAAU,UAAU;AAC9B,kBAAgB,oBAAoB,mCAAK;AAC1C,WAAW,OAAO,wCAAU,YAAY;AACvC,kBAAgB,qBAAqB,mCAAK;AAC3C;AACA,IAAO,kCAAQ;",
  "names": ["headers", "res", "jsonError"]
}
