---
created: 2025-11-11
tags: [local-server, testing, troubleshooting]
aliases: [ローカルサーバーテストガイド]
related: [Video URL List Toolでローカルサーバーテスト.md]
---

# ローカルサーバーテスト完全ガイド（整理版）

## 📋 目次
1. [概要](#概要)
2. [ローカルサーバーの基礎知識](#ローカルサーバーの基礎知識)
3. [実施手順](#実施手順)
4. [つまづきポイントと解決策](#つまづきポイントと解決策)
5. [ログの理解](#ログの理解)
6. [まとめ](#まとめ)

---

## 概要

### 何をしたか？
- YouTube List Tool のローカルサーバー環境でのテスト実施
- file:// プロトコルから http:// プロトコルへの移行
- 本番環境に近い動作確認の実現

### なぜ必要だったか？
- CORS制約の回避
- より本番環境に近い動作確認
- ブラウザ機能の制限解除

### 結果
✅ ローカルサーバー起動成功  
✅ アプリ動作確認完了  
✅ YouTube データ取得成功  
✅ CORS問題なし

---

## ローカルサーバーの基礎知識

### ローカルサーバーとは？
**あなたのPC内で動くWebサーバー**のこと。インターネット上ではなく、自分のPC内だけで動作します。

### 2つのアクセス方法の比較

| 項目 | 方法1：ファイル直接開き | 方法2：ローカルサーバー経由 |
|------|------------------------|---------------------------|
| **URL形式** | `file:///C:/Users/.../index.html` | `http://localhost:8000/index.html` |
| **CORS制約** | ❌ 厳しい（外部APIアクセスがブロックされやすい） | ✅ 緩和（本番と同等） |
| **ブラウザ機能** | ❌ 一部制限される | ✅ フル機能利用可能 |
| **本番環境との近さ** | ❌ 遠い | ✅ 近い |
| **開発推奨度** | ❌ 非推奨 | ✅ **強く推奨** |

### ローカルサーバーの役割
```
[ブラウザ] ──┬──→ [ローカルサーバー:8000]  ← HTML/CSS/JS配信
             │         (PowerShell)
             │
             └──→ [YouTube RSS API]          ← データ取得（直接アクセス）
```

**重要**: ローカルサーバーは静的ファイル（HTML/CSS/JS）を配信するだけで、YouTube APIへのリクエストは中継しません（プロキシではない）。

---

## 実施手順

### ステップ1: プロジェクトディレクトリへ移動
```powershell
cd C:\Users\littl\app-dev\05_YouTubeListTool\YouTubeListTool
```

### ステップ2: Pythonでローカルサーバー起動

#### Windows環境の場合
```powershell
python -m http.server 8000
```

#### Linux/Mac環境の場合
```bash
python3 -m http.server 8000
```

**成功時の表示**:
```
Serving HTTP on :: port 8000 (http://[::]:8000/) ...
```

### ステップ3: ブラウザでアクセス
以下のいずれかのURLをブラウザで開く：

1. `http://localhost:8000`
2. `http://127.0.0.1:8000`
3. `http://[::1]:8000`（IPv6）

または直接：
- `http://localhost:8000/index.html`

### ステップ4: 動作確認
1. チャンネルID/URLを入力
2. 「取得」ボタンをクリック
3. 結果が表示されることを確認

### ステップ5: サーバー停止
```
Ctrl + C（PowerShellで実行）
```

---

## つまづきポイントと解決策

### 🔴 つまづきポイント1: `python3` コマンドが認識されない

#### 症状
```powershell
PS> python3 -m http.server 8000
python3: The term 'python3' is not recognized as a name of a cmdlet, function, script file, or executable program.
```

#### 原因
Windows環境では `python3` コマンドが存在しない（Linux/Macでは存在）

#### 解決策
✅ `python` コマンドを使用
```powershell
python -m http.server 8000
```

#### 環境別コマンド早見表
| OS | コマンド |
|----|---------|
| Windows | `python -m http.server 8000` |
| Linux | `python3 -m http.server 8000` |
| macOS | `python3 -m http.server 8000` |

---

### 🟡 つまづきポイント2: ファイル一覧が表示されない

#### 症状
`http://localhost:8000/` にアクセスしたが、プロジェクトのファイル一覧が表示されず、直接アプリ画面になった。

#### これは正常動作です ✅

#### 理由
プロジェクトのルートディレクトリに `index.html` が存在する場合、Webサーバーは自動的にそのファイルを表示します。

```
http://localhost:8000/
↓ 自動的に変換
http://localhost:8000/index.html
```

これはWebサーバーの標準的な動作（インデックスファイル自動表示）で、**意図された仕様**です。

#### ファイル一覧を見たい場合
`index.html` を別のディレクトリに移動するか、存在しないパスにアクセスする。

---

### 🟡 つまづきポイント3: favicon.ico の404エラー

#### ログに表示される警告
```
::1 - - [31/Oct/2025 06:55:47] code 404, message File not found
::1 - - [31/Oct/2025 06:55:47] "GET /favicon.ico HTTP/1.1" 404 -
```

#### これは問題ではありません ✅

#### 理由
- ブラウザが自動的にサイトのアイコン（favicon）を探している
- 現在プロジェクトに favicon.ico が無いだけ
- **アプリの機能には全く影響なし**

#### 対処不要
このエラーは無視して問題ありません。必要に応じて favicon.ico を追加できますが、必須ではありません。

---

### 🟢 確認ポイント: YouTubeデータ取得時にログが増えない

#### 観察された現象
YouTubeのデータを取得したとき、PowerShellのログに新しい行が追加されなかった。

#### これは正常動作です ✅

#### 理由
アプリの動作の流れ：

**フェーズ1: 静的ファイル読み込み**
```
ブラウザ → ローカルサーバー
「index.html、app.js、style.cssをください」
↓
PowerShellログに記録される ✅
```

**フェーズ2: API呼び出し**
```
ブラウザ（app.js実行中）→ 直接YouTube
「RSSデータをください」
↓
ローカルサーバーを経由しない
↓
PowerShellログには何も記録されない ✅（これが正常）
```

#### 何が分かるか？
- ✅ ローカルサーバーが正常に動作している
- ✅ アプリが正常にファイルを読み込んでいる
- ✅ YouTube APIへの直接アクセスが成功している
- ✅ CORS問題も発生していない（成功しているから）

---

## ログの理解

### ログの読み方

#### 基本フォーマット
```
::1 - - [31/Oct/2025 06:55:46] "GET / HTTP/1.1" 200 -
```

#### 各部分の意味
| 要素 | 説明 | 例 |
|------|------|-----|
| `::1` | アクセス元IP（::1はIPv6のlocalhost） | `::1` または `::ffff:127.0.0.1` |
| `[31/Oct/2025 06:55:46]` | アクセス日時 | タイムスタンプ |
| `"GET / HTTP/1.1"` | HTTPリクエスト | GET / = トップページ取得 |
| `200` | HTTPステータスコード | 200 = 成功 |

### HTTPステータスコード早見表
| コード | 意味 | 状態 |
|--------|------|------|
| 200 | OK（成功） | ✅ 正常 |
| 404 | Not Found（見つからない） | ⚠️ ファイルが存在しない |
| 500 | Internal Server Error | ❌ サーバーエラー |

### 実際のログ例と解説

#### 初回アクセス時のログ
```
::1 - - [31/Oct/2025 06:55:46] "GET / HTTP/1.1" 200 -              ← index.htmlを取得（成功）
::1 - - [31/Oct/2025 06:55:46] "GET /style.css HTTP/1.1" 200 -     ← CSSを取得（成功）
::1 - - [31/Oct/2025 06:55:46] "GET /app.js HTTP/1.1" 200 -        ← JavaScriptを取得（成功）
::1 - - [31/Oct/2025 06:55:47] code 404, message File not found
::1 - - [31/Oct/2025 06:55:47] "GET /favicon.ico HTTP/1.1" 404 -   ← アイコンを探したが無い（問題なし）
```

#### 読み取れる情報
1. ✅ すべての必要なファイル（HTML、CSS、JS）が**200（成功）**で配信されている
2. ✅ アプリが正常に動作している証拠
3. ⚠️ favicon.ico が無いが、これは機能に影響しない

#### 複数回アクセス時のログ
```
::ffff:127.0.0.1 - - [31/Oct/2025 06:55:52] "GET / HTTP/1.1" 200 -
::ffff:127.0.0.1 - - [31/Oct/2025 06:55:52] "GET /style.css HTTP/1.1" 200 -
::ffff:127.0.0.1 - - [31/Oct/2025 06:55:52] "GET /app.js HTTP/1.1" 200 -
::ffff:127.0.0.1 - - [31/Oct/2025 06:55:53] "GET /favicon.ico HTTP/1.1" 404 -
::1 - - [31/Oct/2025 06:56:17] "GET /index.html HTTP/1.1" 200 -
```

#### IPアドレスの違い
- `::1` = IPv6のlocalhost
- `::ffff:127.0.0.1` = IPv4マップドIPv6アドレス（実際は127.0.0.1）
- どちらも自分のPC内からのアクセスを示す

---

## まとめ

### 学んだこと

#### 1. ローカルサーバーの必要性
- ❌ `file://` プロトコルはCORS制約が厳しい
- ✅ `http://localhost` は本番環境に近い動作を実現

#### 2. Windows環境の特性
- `python3` ではなく `python` コマンドを使用
- Linux/Macとは異なる点に注意

#### 3. Webサーバーの標準動作
- `index.html` が存在するとファイル一覧は表示されない
- これは正常な動作（インデックスファイル自動表示）

#### 4. ログの読み方
- 200 = 成功
- 404 = ファイルが見つからない（favicon.ico は無視してOK）
- YouTube APIへのリクエストはログに記録されない（直接アクセスのため）

#### 5. 動作フロー
```
[初回アクセス]
ブラウザ → ローカルサーバー → HTML/CSS/JS配信

[API呼び出し]
ブラウザ → 直接YouTube → データ取得
```

### チェックリスト

#### ✅ 成功の確認項目
- [ ] `python -m http.server 8000` が起動
- [ ] `Serving HTTP on :: port 8000` が表示
- [ ] `http://localhost:8000` でアプリが表示
- [ ] チャンネルIDを入力して「取得」ボタンをクリック
- [ ] YouTube データが正常に取得される
- [ ] PowerShellログに HTML/CSS/JS の 200 が記録される
- [ ] favicon.ico の 404 は無視（問題なし）
- [ ] YouTube データ取得時にログが増えない（正常）

### トラブルシューティング早見表

| 症状 | 原因 | 解決策 |
|------|------|--------|
| `python3` コマンドエラー | Windows環境 | `python` を使用 |
| ファイル一覧が出ない | index.html が存在 | 正常動作（問題なし） |
| favicon.ico 404 | ファイルが無い | 無視してOK |
| YouTube取得時ログなし | 直接アクセス | 正常動作（問題なし） |
| ポート8000が使用中 | 別プロセスが使用 | 別のポート番号を使用（例：8001） |
| PowerShellウィンドウを閉じたらアクセス不可 | サーバー停止 | PowerShellを開いたまま維持 |

### 次のステップ

#### 開発時の推奨フロー
1. PowerShellでプロジェクトディレクトリに移動
2. `python -m http.server 8000` 起動
3. ブラウザで `http://localhost:8000` を開く
4. コード編集
5. ブラウザをリロード（F5）して確認
6. 終了時 `Ctrl + C` でサーバー停止

#### CLAUDE.md との関連
本プロジェクトの CLAUDE.md に記載されている通り：
> CORS によりブラウザ直接アクセスがブロックされる場合があるため、README.md に「ローカル簡易サーバ起動手順」（例：`python -m http.server 8000`）を記載すること。

この対応内容は、上記ルールに従った実践例となります。

---

## 参照
- 元ファイル: `Video URL List Toolでローカルサーバーテスト.md`
- 関連ルール: `CLAUDE.md`
- プロジェクト: YouTube List Tool (Video URL List Tool)

---

**更新日**: 2025-11-11  
**作成理由**: 元のやり取りから網羅的に整理し、後で状況や対策を思い出せるようにするため

