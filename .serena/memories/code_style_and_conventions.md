# コードスタイルと規約

## セキュリティガイドライン

### XSS対策（必須）
- **`textContent` のみ使用**、`innerHTML` は絶対に使用しない
- DOM 操作で HTML タグがエスケープされることを保証する
- ユーザー入力を含む部分は特に注意

実装箇所: `app.js` の全DOM操作関数

### 入力バリデーション
- 正規表現でチャンネルID 形式（`UC` + 22文字）をチェック
- チャンネルURL形式: `youtube.com/channel/UC...`
- 非対応形式（`@username`, `/c/channelname`）は明示的にエラーメッセージを表示

### タイムアウト制御
- 各リクエストは10秒でタイムアウト
- AbortController を使用してタイムアウト実装
- タイムアウト時は分かりやすいエラーメッセージを表示

### RSS改ざん検証
- XML パースエラーで不正なレスポンスを検出
- チャンネルID とURL を検証
- 不正なXMLレスポンスを早期に検出

## コーディング規約

### 関数設計
- 単一責任の原則に従う
- 関数は1つの明確な目的を持つ
- 長い関数は小さな関数に分割する

### 変数命名
- 定数は `UPPER_SNAKE_CASE`（例: `PROXY_CONFIG`, `CHANNEL_ID_REGEX`）
- 関数・変数は `camelCase`（例: `fetchChannelVideos`, `channelId`）
- DOM要素のキャッシュは `UI` オブジェクトに格納

### エラーハンドリング
- 全API呼び出しで `try-catch` を使用
- エラーメッセージは `ERROR_MESSAGES` 定数で管理
- ユーザー入力を含まない固定文言を使用
- エラーは集約してグルーピング表示

### コード構成
- 定数定義を最初にまとめる
- UI要素のキャッシュ（`UI` オブジェクト）
- ユーティリティ関数
- 入力処理関数
- データ取得関数
- UI更新関数
- メインロジック
- イベントリスナー

### パフォーマンス最適化
- DOM要素はキャッシュする（`UI` オブジェクト）
- 配列走査を最適化する
- Promise pool で並列実行を制限（同時3件まで）
